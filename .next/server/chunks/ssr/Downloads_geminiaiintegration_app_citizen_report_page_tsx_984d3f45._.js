module.exports=[67786,a=>{"use strict";var b=a.i(4939),c=a.i(43443),d=a.i(11894),e=a.i(39912),f=a.i(55066),g=a.i(4175),h=a.i(78740),i=a.i(60029);function j({className:a,...c}){return(0,b.jsx)("textarea",{"data-slot":"textarea",className:(0,i.cn)("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),...c})}var k=a.i(66974),l=a.i(72497);let m=(0,l.default)("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);var n=a.i(77248),o=a.i(19235),p=a.i(9378);let q=(0,l.default)("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);var r=a.i(13781);let s=(0,l.default)("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]]);var t=a.i(47954);function u(){let a=(0,d.useRouter)(),[i]=(0,c.useState)("Rajesh Kumar"),[l,u]=(0,c.useState)(!1),[v,w]=(0,c.useState)(null),[x,y]=(0,c.useState)(""),[z,A]=(0,c.useState)(null),[B,C]=(0,c.useState)(""),[D,E]=(0,c.useState)(""),[F,G]=(0,c.useState)(""),[H,I]=(0,c.useState)(!1),[J,K]=(0,c.useState)(!1),[L,M]=(0,c.useState)(!1),[N,O]=(0,c.useState)(null),[P,Q]=(0,c.useState)(null),[R,S]=(0,c.useState)(!1),T=async a=>{let b=a.target.files?.[0];if(b){w(b);let a=new FileReader;a.onloadend=()=>{y(a.result)},a.readAsDataURL(b),M(!1),O(null),z||await U()}},U=async()=>{if(I(!0),Q(null),!navigator.geolocation){A({lat:28.6139,lng:77.209}),C("Connaught Place, New Delhi, Delhi 110001, India"),I(!1);return}navigator.geolocation.getCurrentPosition(async a=>{let b=a.coords.latitude,c=a.coords.longitude;A({lat:b,lng:c});try{let a=await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${b}&lon=${c}`),d=await a.json();C(d.display_name||`${b}, ${c}`)}catch(a){C(`${b}, ${c}`)}I(!1)},a=>{A({lat:28.6139,lng:77.209}),C("Connaught Place, New Delhi, Delhi 110001, India"),I(!1)})},V=async()=>{if(!v||!D||!z)return void Q("Please upload image, add description, and enable location first");K(!0),Q(null);try{let a=x.split(",")[1],b=await fetch("/api/ai/gemini/analyze",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({imageBase64:a,complaintText:D,location:z})}),c=await b.json();if(c.success&&c.analysis)O(c.analysis),M(!0),G(c.analysis.predicted_category),console.log("[v0] AI Analysis complete:",c.analysis);else throw Error("AI analysis failed")}catch(a){console.error("[v0] AI analysis error:",a),Q("AI analysis failed. Please try again.")}finally{K(!1)}},W=async b=>{if(b.preventDefault(),!L)return void Q("Please run AI Analysis before submitting the report");u(!0),Q(null);try{if(!v)throw Error("Please upload an image");if(!z)throw Error("Please enable location");if(!D)throw Error("Please describe the issue");await new Promise(a=>setTimeout(a,1500));let b={id:`report_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,reporter_id:"citizen_mock_id",category:F||N?.predicted_category||"other",status:"submitted",complaint_text:D,latitude:z.lat,longitude:z.lng,address:B||`${z.lat}, ${z.lng}`,severity_score:N?.final_severity||50,severity_level:N?.severity_level||"medium",ai_analysis:N||null,needs_human_review:N?.needs_human_review||!1,assigned_department:N?.assigned_department||null,assigned_worker_id:null,estimated_sla:N?.expected_resolution_time||null,created_at:new Date().toISOString(),updated_at:new Date().toISOString(),completed_at:null,verified_at:null,report_images:[{id:`img_${Date.now()}`,report_id:`report_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,image_url:x,image_type:"original",geotag_latitude:z.lat,geotag_longitude:z.lng,uploaded_by:"citizen_mock_id",created_at:new Date().toISOString()}],profiles:{id:"citizen_mock_id",full_name:i,role:"citizen"}};(0,t.saveReportToStorage)(b),console.log("[v0] Report saved with AI analysis:",b.id),S(!0),setTimeout(()=>{a.push("/citizen/dashboard")},2e3)}catch(a){Q(a.message||"Failed to submit report")}finally{u(!1)}};return R?(0,b.jsxs)("div",{className:"min-h-screen bg-background",children:[(0,b.jsx)(e.NavHeader,{userName:i}),(0,b.jsx)("main",{className:"container px-4 md:px-6 py-8",children:(0,b.jsx)(f.Card,{className:"max-w-2xl mx-auto",children:(0,b.jsxs)(f.CardContent,{className:"flex flex-col items-center justify-center py-12 text-center",children:[(0,b.jsx)(p.CheckCircle,{className:"h-16 w-16 text-green-500 mb-4"}),(0,b.jsx)("h2",{className:"text-2xl font-bold mb-2",children:"रिपोर्ट सफलतापूर्वक जमा की गई!"}),(0,b.jsx)("p",{className:"text-lg font-semibold mb-2",children:"Report Submitted Successfully!"}),(0,b.jsx)("p",{className:"text-muted-foreground mb-4",children:"You earned 10 EcoCoins"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Redirecting to dashboard..."})]})})})]}):(0,b.jsxs)("div",{className:"min-h-screen bg-background",children:[(0,b.jsx)(e.NavHeader,{userName:i}),(0,b.jsx)("main",{className:"container px-4 md:px-6 py-8",children:(0,b.jsx)("div",{className:"max-w-2xl mx-auto",children:(0,b.jsxs)(f.Card,{children:[(0,b.jsxs)(f.CardHeader,{children:[(0,b.jsx)(f.CardTitle,{children:"नागरिक समस्या रिपोर्ट करें / Report a Civic Issue"}),(0,b.jsx)(f.CardDescription,{children:"Help make your community better by reporting problems"})]}),(0,b.jsx)(f.CardContent,{children:(0,b.jsxs)("form",{onSubmit:W,className:"space-y-6",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(h.Label,{htmlFor:"image",children:"Upload Image / फोटो अपलोड करें *"}),(0,b.jsx)("div",{className:"flex flex-col gap-4",children:x?(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)("img",{src:x||"/placeholder.svg",alt:"Preview",className:"w-full h-64 object-cover rounded-lg"}),(0,b.jsx)(g.Button,{type:"button",variant:"secondary",size:"sm",className:"absolute top-2 right-2",onClick:()=>{w(null),y(""),M(!1),O(null)},children:"Change"})]}):(0,b.jsxs)("div",{className:"border-2 border-dashed border-border rounded-lg p-8 text-center hover:border-primary transition-colors cursor-pointer",children:[(0,b.jsx)("input",{id:"image",type:"file",accept:"image/*",capture:"environment",onChange:T,className:"hidden"}),(0,b.jsxs)("label",{htmlFor:"image",className:"cursor-pointer flex flex-col items-center gap-2",children:[(0,b.jsx)(m,{className:"h-12 w-12 text-muted-foreground"}),(0,b.jsxs)("div",{className:"text-sm",children:[(0,b.jsx)("span",{className:"text-primary font-medium",children:"Click to upload"})," or use camera"]}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"PNG, JPG up to 10MB"})]})]})})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(h.Label,{children:"Location / स्थान *"}),(0,b.jsx)("div",{className:"flex gap-2",children:(0,b.jsx)(g.Button,{type:"button",variant:"outline",onClick:U,disabled:H,className:"w-full bg-transparent",children:H?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(o.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),"Getting location..."]}):z?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(p.CheckCircle,{className:"mr-2 h-4 w-4 text-green-500"}),"Location captured"]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(n.MapPin,{className:"mr-2 h-4 w-4"}),"Get Current Location"]})})}),B&&(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:B})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(h.Label,{htmlFor:"complaint",children:"Describe the Issue / समस्या का विवरण *"}),(0,b.jsx)(j,{id:"complaint",placeholder:"Describe what you see and why it's a problem... (समस्या का विवरण दें)",value:D,onChange:a=>E(a.target.value),required:!0,rows:4})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Button,{type:"button",onClick:V,disabled:J||!v||!z||!D,className:"w-full bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700",size:"lg",children:J?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(o.Loader2,{className:"mr-2 h-5 w-5 animate-spin"}),"Analyzing with AI..."]}):L?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(p.CheckCircle,{className:"mr-2 h-5 w-5"}),"AI Analysis Complete"]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(s,{className:"mr-2 h-5 w-5"}),"Run AI Analysis"]})}),!L&&!J&&(0,b.jsx)("p",{className:"text-xs text-center text-muted-foreground",children:"AI analysis is required before submitting the report"})]}),N&&L&&(0,b.jsx)("div",{className:"space-y-4 p-4 rounded-lg bg-gradient-to-br from-blue-50 to-purple-50 dark:from-blue-950/30 dark:to-purple-950/30 border border-blue-200 dark:border-blue-800",children:(0,b.jsxs)("div",{className:"flex items-start gap-2",children:[(0,b.jsx)(s,{className:"h-5 w-5 text-blue-600 dark:text-blue-400 mt-0.5"}),(0,b.jsxs)("div",{className:"flex-1 space-y-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-bold text-blue-900 dark:text-blue-100",children:"AI Analysis Results"}),(0,b.jsx)("p",{className:"text-sm text-blue-700 dark:text-blue-300 mt-1",children:N.description})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"font-medium",children:"Category:"})," ",(0,b.jsx)("span",{className:"text-blue-700 dark:text-blue-300",children:N.predicted_category.replace(/_/g," ").toUpperCase()})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"font-medium",children:"Confidence:"})," ",(0,b.jsxs)("span",{className:"text-blue-700 dark:text-blue-300",children:[(100*N.category_confidence).toFixed(0),"%"]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"font-medium",children:"Severity:"})," ",(0,b.jsxs)("span",{className:"critical"===N.severity_level?"text-red-600 font-bold":"high"===N.severity_level?"text-orange-600 font-bold":"text-blue-700",children:[N.severity_level.toUpperCase()," (",N.final_severity,")"]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"font-medium",children:"Department:"})," ",(0,b.jsx)("span",{className:"text-blue-700 dark:text-blue-300",children:N.assigned_department})]})]}),N.health_risks&&N.health_risks.length>0&&(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-medium text-sm mb-1",children:"Health Risks:"}),(0,b.jsx)("div",{className:"flex flex-wrap gap-1",children:N.health_risks.map((a,c)=>(0,b.jsx)("span",{className:"text-xs px-2 py-1 rounded-full bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-300",children:a},c))})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-medium text-sm mb-1",children:"Resolution Time:"}),(0,b.jsx)("p",{className:"text-xs text-blue-700 dark:text-blue-300",children:N.expected_resolution_time})]}),N.auto_escalate&&(0,b.jsx)("div",{className:"p-2 rounded bg-red-100 dark:bg-red-900/30 border border-red-300 dark:border-red-700",children:(0,b.jsxs)("p",{className:"text-xs font-medium text-red-900 dark:text-red-100",children:["⚠️ Auto-Escalated: ",N.escalation_reason]})})]})]})}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(h.Label,{htmlFor:"category",children:"Category / श्रेणी"}),(0,b.jsxs)(k.Select,{value:F,onValueChange:a=>G(a),disabled:!0,children:[(0,b.jsx)(k.SelectTrigger,{children:(0,b.jsx)(k.SelectValue,{placeholder:N?`AI detected: ${N.predicted_category.replace(/_/g," ")}`:"Run AI analysis first"})}),(0,b.jsxs)(k.SelectContent,{children:[(0,b.jsx)(k.SelectItem,{value:"pothole",children:"गड्ढा / Pothole"}),(0,b.jsx)(k.SelectItem,{value:"waste_overflow",children:"कचरा ओवरफ्लो / Waste Overflow"}),(0,b.jsx)(k.SelectItem,{value:"streetlight_out",children:"स्ट्रीटलाइट बंद / Streetlight Out"}),(0,b.jsx)(k.SelectItem,{value:"traffic_signal_fault",children:"ट्रैफिक सिग्नल खराब / Traffic Signal Fault"}),(0,b.jsx)(k.SelectItem,{value:"carcass_on_road",children:"सड़क पर पशु शव / Animal Carcass on Road"}),(0,b.jsx)(k.SelectItem,{value:"public_toilet_unclean",children:"सार्वजनिक शौचालय गंदा / Public Toilet Unclean"}),(0,b.jsx)(k.SelectItem,{value:"damaged_pathway",children:"क्षतिग्रस्त रास्ता / Damaged Pathway"}),(0,b.jsx)(k.SelectItem,{value:"other",children:"अन्य / Other"})]})]}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Category is auto-detected by AI"})]}),P&&(0,b.jsxs)("div",{className:"p-3 rounded-lg bg-destructive/10 text-destructive text-sm flex items-start gap-2",children:[(0,b.jsx)(r.AlertCircle,{className:"h-5 w-5 mt-0.5"}),(0,b.jsx)("span",{children:P})]}),(0,b.jsx)(g.Button,{type:"submit",className:"w-full",disabled:l||!L,size:"lg",children:l?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(o.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),"Submitting..."]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(q,{className:"mr-2 h-4 w-4"}),"Submit Report / रिपोर्ट जमा करें"]})}),!L&&(0,b.jsx)("p",{className:"text-xs text-center text-muted-foreground",children:"Please run AI analysis before submitting"})]})})]})})})]})}a.s(["default",()=>u],67786)}];

//# sourceMappingURL=Downloads_geminiaiintegration_app_citizen_report_page_tsx_984d3f45._.js.map