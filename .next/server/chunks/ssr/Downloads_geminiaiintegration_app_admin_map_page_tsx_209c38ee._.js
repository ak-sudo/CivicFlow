module.exports=[79293,a=>{"use strict";var b=a.i(4939),c=a.i(5350),d=a.i(39425),e=a.i(55066),f=a.i(2300),g=a.i(4175),h=a.i(77248);let i=(0,a.i(72497).default)("Maximize2",[["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["polyline",{points:"9 21 3 21 3 15",key:"1avn1i"}],["line",{x1:"21",x2:"14",y1:"3",y2:"10",key:"ota7mn"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]);var j=a.i(6606),k=a.i(83432),l=a.i(43443);function m({reports:a,isExpanded:c=!1}){var d;let e=(0,l.useRef)(null),f=(0,l.useRef)(null),[g,h]=(0,l.useState)(null),[i,j]=(0,l.useState)({x:0,y:0}),[k,m]=(0,l.useState)(12),[n,o]=(0,l.useState)({lat:28.6139,lng:77.209}),[p,q]=(0,l.useState)(!0);(0,l.useEffect)(()=>{a.length>0&&o({lat:a.reduce((a,b)=>a+b.lat,0)/a.length,lng:a.reduce((a,b)=>a+b.lng,0)/a.length})},[a]),(0,l.useEffect)(()=>{if(!f.current||!e.current||!p)return;let b=f.current,c=b.getContext("2d");if(!c)return;let d=e.current.clientWidth,g=e.current.clientHeight;b.width=d,b.height=g,c.clearRect(0,0,d,g),a.forEach(a=>{let b=B(a.lat,a.lng);if(b.x<-100||b.x>d+100||b.y<-100||b.y>g+100)return;let e={low:.3,medium:.5,high:.7,critical:1}[a.severity],f=c.createRadialGradient(b.x,b.y,0,b.x,b.y,60);f.addColorStop(0,`rgba(255, 100, 100, ${.6*e})`),f.addColorStop(.5,`rgba(255, 150, 50, ${.3*e})`),f.addColorStop(1,"rgba(255, 200, 0, 0)"),c.fillStyle=f,c.fillRect(b.x-60,b.y-60,120,120)})},[a,k,n,p]);let r=(a,b,c)=>{let d=256*Math.pow(2,c),e=a*Math.PI/180,f=(1-Math.log(Math.tan(e)+1/Math.cos(e))/Math.PI)/2*d;return{x:(b+180)/360*d,y:f}},s={low:"#22c55e",medium:"#eab308",high:"#f97316",critical:"#ef4444"},t=e.current?.clientWidth||1200,u=e.current?.clientHeight||800,v=(d=n.lat,{x:Math.floor((n.lng+180)/360*Math.pow(2,k)),y:Math.floor((1-Math.log(Math.tan(d*Math.PI/180)+1/Math.cos(d*Math.PI/180))/Math.PI)/2*Math.pow(2,k))}),w=r(n.lat,n.lng,k),x=Math.ceil(t/256)+2,y=Math.ceil(u/256)+2,z=v.x-Math.floor(x/2),A=v.y-Math.floor(y/2),B=(a,b)=>{let c=r(a,b,k);return{x:c.x-w.x+t/2,y:c.y-w.y+u/2}};return(0,b.jsxs)("div",{ref:e,className:"relative w-full h-full bg-gray-200 overflow-hidden",onWheel:a=>{a.preventDefault();let b=a.deltaY>0?-1:1;m(a=>Math.max(10,Math.min(18,a+b)))},children:[(0,b.jsx)("div",{className:"absolute inset-0",style:{transform:`translate(${-(w.x%256)}px, ${-(w.y%256)}px)`},children:Array.from({length:y}).map((a,c)=>Array.from({length:x}).map((a,d)=>{let e=z+d,f=A+c,g=`https://tile.openstreetmap.org/${k}/${e}/${f}.png`;return(0,b.jsx)("img",{src:g||"/placeholder.svg",alt:"",className:"absolute pointer-events-none",style:{left:256*d,top:256*c,width:256,height:256},onError:a=>{a.target.style.backgroundColor="#e5e7eb"}},`${e}-${f}`)}))}),(0,b.jsx)("canvas",{ref:f,className:"absolute inset-0 pointer-events-none",style:{opacity:.6*!!p,mixBlendMode:"multiply",transition:"opacity 0.3s ease"}}),a.map(a=>{let c=B(a.lat,a.lng);return c.x<-50||c.x>t+50||c.y<-50||c.y>u+50?null:(0,b.jsx)("div",{className:"absolute transform -translate-x-1/2 -translate-y-full cursor-pointer transition-transform hover:scale-110",style:{left:c.x,top:c.y,zIndex:10},onMouseEnter:b=>{let c;return h(a),void((c=e.current?.getBoundingClientRect())&&j({x:b.clientX-c.left,y:b.clientY-c.top}))},onMouseLeave:()=>h(null),children:(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)("div",{className:"w-8 h-8 rounded-full border-4 border-white shadow-lg flex items-center justify-center",style:{backgroundColor:s[a.severity]},children:(0,b.jsx)("svg",{className:"w-4 h-4 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:(0,b.jsx)("path",{fillRule:"evenodd",d:"M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z",clipRule:"evenodd"})})}),(0,b.jsx)("div",{className:"absolute left-1/2 top-full w-0 h-0 transform -translate-x-1/2",style:{borderLeft:"6px solid transparent",borderRight:"6px solid transparent",borderTop:`12px solid ${s[a.severity]}`}})]})},a.id)}),g&&(0,b.jsxs)("div",{className:"absolute bg-white rounded-lg shadow-xl p-4 pointer-events-none z-50 border border-gray-200",style:{left:i.x+20,top:i.y-60,maxWidth:"300px"},children:[(0,b.jsx)("h3",{className:"font-semibold text-sm mb-2",children:g.complaint}),(0,b.jsx)("p",{className:"text-xs text-gray-600 mb-2",children:g.address}),(0,b.jsxs)("p",{className:"text-xs text-gray-500 mb-2",children:["ðŸ“ ",g.lat.toFixed(5),", ",g.lng.toFixed(5)]}),(0,b.jsx)("span",{className:`inline-block px-2 py-1 rounded text-xs font-medium ${"critical"===g.severity?"bg-red-100 text-red-700":"high"===g.severity?"bg-orange-100 text-orange-700":"medium"===g.severity?"bg-yellow-100 text-yellow-700":"bg-green-100 text-green-700"}`,children:g.severity.toUpperCase()})]}),(0,b.jsxs)("div",{className:"absolute top-4 right-4 bg-white/95 backdrop-blur-sm p-3 rounded-lg shadow-lg space-y-2",children:[(0,b.jsx)("p",{className:"text-xs font-semibold mb-2",children:"Severity / à¤—à¤‚à¤­à¥€à¤°à¤¤à¤¾"}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("div",{className:"w-3 h-3 rounded-full bg-red-500"}),(0,b.jsx)("span",{className:"text-xs",children:"Critical"})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("div",{className:"w-3 h-3 rounded-full bg-orange-500"}),(0,b.jsx)("span",{className:"text-xs",children:"High"})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("div",{className:"w-3 h-3 rounded-full bg-yellow-500"}),(0,b.jsx)("span",{className:"text-xs",children:"Medium"})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("div",{className:"w-3 h-3 rounded-full bg-green-500"}),(0,b.jsx)("span",{className:"text-xs",children:"Low"})]}),(0,b.jsx)("div",{className:"pt-2 border-t border-gray-200 mt-2",children:(0,b.jsxs)("button",{onClick:()=>q(!p),className:"text-xs text-primary hover:underline w-full text-left",children:[p?"Hide":"Show"," Heatmap"]})})]}),(0,b.jsxs)("div",{className:"absolute bottom-4 left-4 bg-white/95 backdrop-blur-sm p-3 rounded-lg shadow-lg",children:[(0,b.jsx)("p",{className:"text-sm font-semibold",children:"ðŸ“ Active Reports Map"}),(0,b.jsxs)("p",{className:"text-xs text-muted-foreground mt-1",children:[a.length," reports on map"]}),(0,b.jsxs)("p",{className:"text-xs text-muted-foreground mt-1",children:["Zoom Level: ",k]}),(0,b.jsxs)("p",{className:"text-xs text-muted-foreground mt-1",children:["Center: ",n.lat.toFixed(4),", ",n.lng.toFixed(4)]}),(0,b.jsxs)("div",{className:"flex gap-2 mt-2",children:[(0,b.jsx)("button",{onClick:()=>m(a=>Math.min(18,a+1)),className:"px-2 py-1 bg-primary text-primary-foreground rounded text-xs hover:bg-primary/90",children:"Zoom In"}),(0,b.jsx)("button",{onClick:()=>m(a=>Math.max(10,a-1)),className:"px-2 py-1 bg-primary text-primary-foreground rounded text-xs hover:bg-primary/90",children:"Zoom Out"}),(0,b.jsx)("button",{onClick:()=>{a.length>0?(o({lat:a.reduce((a,b)=>a+b.lat,0)/a.length,lng:a.reduce((a,b)=>a+b.lng,0)/a.length}),m(12)):(m(12),o({lat:28.6139,lng:77.209}))},className:"px-2 py-1 bg-secondary text-secondary-foreground rounded text-xs hover:bg-secondary/90",children:"Reset"})]})]})]})}var n=a.i(47954);function o(){let{t:a}=(0,k.useLanguage)(),[o,p]=(0,l.useState)(!1),[q,r]=(0,l.useState)(""),[s,t]=(0,l.useState)([]);(0,l.useEffect)(()=>{let a=()=>{t((0,n.getReportsFromStorage)().filter(a=>a.latitude&&a.longitude))};a();let b=()=>a();return window.addEventListener("reportsUpdated",b),()=>window.removeEventListener("reportsUpdated",b)},[]);let u=s.map(a=>({id:a.id,lat:a.latitude,lng:a.longitude,severity:a.severity_level||"medium",address:a.address||`${a.latitude}, ${a.longitude}`,complaint:a.complaint_text})),v=q?u.filter(a=>a.address.toLowerCase().includes(q.toLowerCase())||a.complaint.toLowerCase().includes(q.toLowerCase())):u,w={low:"bg-green-500/10 text-green-700",medium:"bg-yellow-500/10 text-yellow-700",high:"bg-orange-500/10 text-orange-700",critical:"bg-red-500/10 text-red-700"},x={total:v.length,critical:v.filter(a=>"critical"===a.severity).length,high:v.filter(a=>"high"===a.severity).length,medium:v.filter(a=>"medium"===a.severity).length,low:v.filter(a=>"low"===a.severity).length};return(0,b.jsxs)("div",{className:"flex min-h-screen",children:[(0,b.jsx)(c.AdminSidebar,{}),(0,b.jsxs)("div",{className:"flex-1 flex flex-col ml-64 overflow-y-auto",children:[(0,b.jsx)(d.AdminTopNav,{userName:"à¤¸à¥à¤¨à¥€à¤¤à¤¾ à¤®à¥‡à¤¹à¤¤à¤¾ / Sunita Mehta",onSearch:r}),(0,b.jsx)("main",{className:"flex-1 p-6 max-w-7xl w-full mx-auto",children:(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"text-center mx-auto",children:[(0,b.jsx)("h1",{className:"text-3xl font-bold",children:a("admin.map")}),(0,b.jsx)("p",{className:"text-muted-foreground mt-1",children:"Geographic view of all civic reports with heatmap"})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:[(0,b.jsxs)(e.Card,{children:[(0,b.jsx)(e.CardHeader,{className:"pb-2",children:(0,b.jsx)(e.CardTitle,{className:"text-sm font-medium",children:"Total Reports"})}),(0,b.jsxs)(e.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold",children:x.total}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"On map"})]})]}),(0,b.jsxs)(e.Card,{className:"border-red-200 bg-red-50/50",children:[(0,b.jsx)(e.CardHeader,{className:"pb-2",children:(0,b.jsx)(e.CardTitle,{className:"text-sm font-medium text-red-700",children:"Critical"})}),(0,b.jsxs)(e.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold text-red-700",children:x.critical}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"Urgent action"})]})]}),(0,b.jsxs)(e.Card,{className:"border-orange-200 bg-orange-50/50",children:[(0,b.jsx)(e.CardHeader,{className:"pb-2",children:(0,b.jsx)(e.CardTitle,{className:"text-sm font-medium text-orange-700",children:"High"})}),(0,b.jsxs)(e.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold text-orange-700",children:x.high}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"Priority"})]})]}),(0,b.jsxs)(e.Card,{className:"border-yellow-200 bg-yellow-50/50",children:[(0,b.jsx)(e.CardHeader,{className:"pb-2",children:(0,b.jsx)(e.CardTitle,{className:"text-sm font-medium text-yellow-700",children:"Medium"})}),(0,b.jsxs)(e.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold text-yellow-700",children:x.medium}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"Standard"})]})]}),(0,b.jsxs)(e.Card,{className:"border-green-200 bg-green-50/50",children:[(0,b.jsx)(e.CardHeader,{className:"pb-2",children:(0,b.jsx)(e.CardTitle,{className:"text-sm font-medium text-green-700",children:"Low"})}),(0,b.jsxs)(e.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold text-green-700",children:x.low}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"Routine"})]})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,b.jsxs)(e.Card,{className:`${o?"fixed inset-4 z-50 lg:col-span-3":"lg:col-span-2"}`,children:[(0,b.jsxs)(e.CardHeader,{className:"flex flex-row items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(e.CardTitle,{children:"à¤°à¤¿à¤ªà¥‹à¤°à¥à¤Ÿ à¤®à¤¾à¤¨à¤šà¤¿à¤¤à¥à¤° / Reports Map with Heatmap"}),(0,b.jsx)(e.CardDescription,{children:"Interactive map showing report locations and issue density"})]}),(0,b.jsx)(g.Button,{variant:"outline",size:"icon",onClick:()=>p(!o),className:"flex-shrink-0",children:o?(0,b.jsx)(j.X,{className:"h-4 w-4"}):(0,b.jsx)(i,{className:"h-4 w-4"})})]}),(0,b.jsx)(e.CardContent,{children:(0,b.jsx)("div",{className:`${o?"h-[calc(100vh-12rem)]":"h-[600px]"} rounded-lg overflow-hidden`,children:(0,b.jsx)(m,{reports:v,isExpanded:o})})})]}),!o&&(0,b.jsxs)(e.Card,{children:[(0,b.jsxs)(e.CardHeader,{children:[(0,b.jsx)(e.CardTitle,{children:"à¤¸à¥à¤¥à¤¾à¤¨ à¤•à¥‡ à¤…à¤¨à¥à¤¸à¤¾à¤° à¤°à¤¿à¤ªà¥‹à¤°à¥à¤Ÿ / Reports by Location"}),(0,b.jsxs)(e.CardDescription,{children:[v.length," active reports"]})]}),(0,b.jsx)(e.CardContent,{children:(0,b.jsx)("div",{className:"space-y-3 max-h-[600px] overflow-y-auto",children:0===v.length?(0,b.jsxs)("div",{className:"text-center py-8 text-sm text-muted-foreground",children:[(0,b.jsx)(h.MapPin,{className:"h-12 w-12 mx-auto mb-3 text-muted-foreground/50"}),(0,b.jsx)("p",{children:"No reports with location data yet"}),(0,b.jsx)("p",{className:"text-xs mt-2",children:"Reports will appear here once citizens submit issues"})]}):v.map(a=>(0,b.jsxs)("a",{href:`/admin/reports/${a.id}`,className:"flex items-start gap-3 p-3 rounded-lg border border-border hover:bg-muted/50 transition-colors",children:[(0,b.jsx)(h.MapPin,{className:"h-5 w-5 text-primary mt-0.5 flex-shrink-0"}),(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsx)("p",{className:"font-medium text-sm line-clamp-1",children:a.complaint}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground mt-1 line-clamp-2",children:a.address}),(0,b.jsxs)("p",{className:"text-xs text-muted-foreground mt-1 font-mono",children:["ðŸ“ ",a.lat.toFixed(5),", ",a.lng.toFixed(5)]}),(0,b.jsx)(f.Badge,{variant:"secondary",className:`mt-2 ${w[a.severity]}`,children:a.severity})]})]},a.id))})})]})]})]})})]})]})}a.s(["default",()=>o],79293)}];

//# sourceMappingURL=Downloads_geminiaiintegration_app_admin_map_page_tsx_209c38ee._.js.map