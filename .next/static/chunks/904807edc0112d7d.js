(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,42584,e=>{"use strict";let t=(0,e.i(68385).default)("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);e.s(["MapPin",()=>t],42584)},42972,e=>{"use strict";var t=e.i(51537),r=e.i(52299);function a({className:e,type:a,...s}){return(0,t.jsx)("input",{type:a,"data-slot":"input",className:(0,r.cn)("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",e),...s})}e.s(["Input",()=>a])},8673,e=>{"use strict";let t="civicflow_reports";function r(){try{let e=localStorage.getItem(t);return e?JSON.parse(e):[]}catch{return[]}}function a(e){try{let a=r();e.timeline||(e.timeline=[{id:`timeline_${Date.now()}`,action:"Report submitted",created_at:new Date().toISOString(),actor_name:e.profiles?.full_name||"Citizen",details:{category:e.category,severity:e.severity_level,ai_confidence:e.ai_analysis?.category_confidence}}]),a.unshift(e),localStorage.setItem(t,JSON.stringify(a)),window.dispatchEvent(new CustomEvent("reportsUpdated",{detail:{reports:a}}))}catch(e){console.error("Failed to save report to localStorage:",e)}}function s(e,a){try{let s=r(),l=s.findIndex(t=>t.id===e);if(-1!==l){if(a.status&&a.status!==s[l].status){let e={id:`timeline_${Date.now()}`,action:`Status changed to ${a.status}`,created_at:new Date().toISOString(),actor_name:"completed"===a.status?"Worker":"System"};s[l].timeline=s[l].timeline||[],s[l].timeline.unshift(e)}("completed"===a.status||"verified"===a.status)&&(a.verified_at=new Date().toISOString()),s[l]={...s[l],...a,updated_at:new Date().toISOString()},localStorage.setItem(t,JSON.stringify(s)),window.dispatchEvent(new CustomEvent("reportsUpdated",{detail:{reports:s}}))}}catch(e){console.error("Failed to update report in localStorage:",e)}}function l(e){return r().find(t=>t.id===e)||null}e.s(["getReportById",()=>l,"getReportsFromStorage",()=>r,"saveReportToStorage",()=>a,"updateReportInStorage",()=>s])},85258,e=>{"use strict";let t=(0,e.i(68385).default)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);e.s(["AlertCircle",()=>t],85258)},82397,e=>{"use strict";let t=(0,e.i(68385).default)("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);e.s(["FileText",()=>t],82397)},11255,7455,26668,28606,15887,74095,e=>{"use strict";var t=e.i(51537),r=e.i(43638),a=e.i(16221),s=e.i(52299),l=e.i(3908),n=e.i(68385);let i=(0,n.default)("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);var o=e.i(82397);let d=(0,n.default)("Map",[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]]);var c=e.i(85258),x=e.i(95658);let m=(0,n.default)("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);e.s(["Building2",()=>m],7455);let h=(0,n.default)("ChartColumn",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);e.s(["BarChart3",()=>h],26668);let u=(0,n.default)("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);e.s(["Settings",()=>u],28606);let p=(0,n.default)("ScrollText",[["path",{d:"M15 12h-5",key:"r7krc0"}],["path",{d:"M15 8h-5",key:"1khuty"}],["path",{d:"M19 17V5a2 2 0 0 0-2-2H4",key:"zz82l3"}],["path",{d:"M8 21h12a2 2 0 0 0 2-2v-1a1 1 0 0 0-1-1H11a1 1 0 0 0-1 1v1a2 2 0 1 1-4 0V5a2 2 0 1 0-4 0v2a1 1 0 0 0 1 1h3",key:"1ph1d7"}]]);e.s(["ScrollText",()=>p],15887);var g=e.i(48489);function f(){let e=(0,a.usePathname)(),{t:n}=(0,g.useLanguage)(),f=[{name:n("admin.dashboard"),href:"/admin/dashboard",icon:i},{name:n("admin.reports"),href:"/admin/reports",icon:o.FileText},{name:n("admin.map"),href:"/admin/map",icon:d},{name:n("admin.review"),href:"/admin/review",icon:c.AlertCircle},{name:n("admin.workers"),href:"/admin/workers",icon:x.Users},{name:n("admin.departments"),href:"/admin/departments",icon:m},{name:n("admin.analytics"),href:"/admin/analytics",icon:h},{name:n("admin.audit"),href:"/admin/audit",icon:p},{name:n("admin.settings"),href:"/admin/settings",icon:u}];return(0,t.jsxs)("aside",{className:"hidden lg:flex flex-col w-64 pb-3 bg-muted/30 fixed h-screen overflow-y-auto",children:[(0,t.jsx)("div",{className:"p-6",children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(l.default,{src:"/civiflow-logo.png",alt:"CivicFlow Logo",width:36,height:36,className:"object-contain"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-bold text-lg",children:n("app.name")}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:n("admin.panel")})]})]})}),(0,t.jsx)("nav",{className:"flex-1 px-4 space-y-1",children:f.map(a=>{let l=e===a.href;return(0,t.jsxs)(r.default,{href:a.href,className:(0,s.cn)("flex items-center gap-3 px-3 py-2 rounded-lg text-sm font-medium transition-colors",l?"bg-primary text-primary-foreground":"text-muted-foreground hover:bg-muted hover:text-foreground"),children:[(0,t.jsx)(a.icon,{className:"h-5 w-5"}),a.name]},a.href)})})]})}e.s(["AdminSidebar",()=>f],11255);var v=e.i(80486),y=e.i(42972),j=e.i(32749);let b=(0,n.default)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);var w=e.i(87672),N=e.i(3305),C=e.i(14782),k=e.i(9704);let M=(0,n.default)("Languages",[["path",{d:"m5 8 6 6",key:"1wu5hv"}],["path",{d:"m4 14 6-6 2-3",key:"1k1g8d"}],["path",{d:"M2 5h12",key:"or177f"}],["path",{d:"M7 2h1",key:"1t2jsx"}],["path",{d:"m22 22-5-10-5 10",key:"don7ne"}],["path",{d:"M14 18h6",key:"1m8k6r"}]]);function S(){let{language:e,setLanguage:r}=(0,g.useLanguage)();return(0,t.jsxs)(C.DropdownMenu,{children:[(0,t.jsx)(C.DropdownMenuTrigger,{asChild:!0,children:(0,t.jsx)(v.Button,{variant:"ghost",size:"icon",className:"relative",children:(0,t.jsx)(M,{className:"h-5 w-5"})})}),(0,t.jsxs)(C.DropdownMenuContent,{align:"end",children:[(0,t.jsx)(C.DropdownMenuItem,{onClick:()=>r("en"),className:"en"===e?"bg-accent":"",children:"English"}),(0,t.jsx)(C.DropdownMenuItem,{onClick:()=>r("hi"),className:"hi"===e?"bg-accent":"",children:"à¤¹à¤¿à¤‚à¤¦à¥€ (Hindi)"})]})]})}var R=e.i(58987),P=e.i(8673),D=e.i(63565),_=e.i(2009),A=e.i(21359),E=e.i(16216),F=e.i(39858),I=e.i(58008),T=e.i(81701),H=e.i(85617),O=e.i(51550),z=e.i(84348),L=e.i(84085),$=e.i(67746),B=e.i(4541),U=e.i(26889),q=e.i(26452),V="Popover",[Z,W]=(0,A.createContextScope)(V,[H.createPopperScope]),X=(0,H.createPopperScope)(),[G,J]=Z(V),K=e=>{let{__scopePopover:r,children:a,open:s,defaultOpen:l,onOpenChange:n,modal:i=!1}=e,o=X(r),d=R.useRef(null),[c,x]=R.useState(!1),[m=!1,h]=(0,B.useControllableState)({prop:s,defaultProp:l,onChange:n});return(0,t.jsx)(H.Root,{...o,children:(0,t.jsx)(G,{scope:r,contentId:(0,T.useId)(),triggerRef:d,open:m,onOpenChange:h,onOpenToggle:R.useCallback(()=>h(e=>!e),[h]),hasCustomAnchor:c,onCustomAnchorAdd:R.useCallback(()=>x(!0),[]),onCustomAnchorRemove:R.useCallback(()=>x(!1),[]),modal:i,children:a})})};K.displayName=V;var Y="PopoverAnchor";R.forwardRef((e,r)=>{let{__scopePopover:a,...s}=e,l=J(Y,a),n=X(a),{onCustomAnchorAdd:i,onCustomAnchorRemove:o}=l;return R.useEffect(()=>(i(),()=>o()),[i,o]),(0,t.jsx)(H.Anchor,{...n,...s,ref:r})}).displayName=Y;var Q="PopoverTrigger",ee=R.forwardRef((e,r)=>{let{__scopePopover:a,...s}=e,l=J(Q,a),n=X(a),i=(0,_.useComposedRefs)(r,l.triggerRef),o=(0,t.jsx)(L.Primitive.button,{type:"button","aria-haspopup":"dialog","aria-expanded":l.open,"aria-controls":l.contentId,"data-state":ex(l.open),...s,ref:i,onClick:(0,D.composeEventHandlers)(e.onClick,l.onOpenToggle)});return l.hasCustomAnchor?o:(0,t.jsx)(H.Anchor,{asChild:!0,...n,children:o})});ee.displayName=Q;var et="PopoverPortal",[er,ea]=Z(et,{forceMount:void 0}),es=e=>{let{__scopePopover:r,forceMount:a,children:s,container:l}=e,n=J(et,r);return(0,t.jsx)(er,{scope:r,forceMount:a,children:(0,t.jsx)(z.Presence,{present:a||n.open,children:(0,t.jsx)(O.Portal,{asChild:!0,container:l,children:s})})})};es.displayName=et;var el="PopoverContent",en=R.forwardRef((e,r)=>{let a=ea(el,e.__scopePopover),{forceMount:s=a.forceMount,...l}=e,n=J(el,e.__scopePopover);return(0,t.jsx)(z.Presence,{present:s||n.open,children:n.modal?(0,t.jsx)(ei,{...l,ref:r}):(0,t.jsx)(eo,{...l,ref:r})})});en.displayName=el;var ei=R.forwardRef((e,r)=>{let a=J(el,e.__scopePopover),s=R.useRef(null),l=(0,_.useComposedRefs)(r,s),n=R.useRef(!1);return R.useEffect(()=>{let e=s.current;if(e)return(0,U.hideOthers)(e)},[]),(0,t.jsx)(q.RemoveScroll,{as:$.Slot,allowPinchZoom:!0,children:(0,t.jsx)(ed,{...e,ref:l,trapFocus:a.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:(0,D.composeEventHandlers)(e.onCloseAutoFocus,e=>{e.preventDefault(),n.current||a.triggerRef.current?.focus()}),onPointerDownOutside:(0,D.composeEventHandlers)(e.onPointerDownOutside,e=>{let t=e.detail.originalEvent,r=0===t.button&&!0===t.ctrlKey;n.current=2===t.button||r},{checkForDefaultPrevented:!1}),onFocusOutside:(0,D.composeEventHandlers)(e.onFocusOutside,e=>e.preventDefault(),{checkForDefaultPrevented:!1})})})}),eo=R.forwardRef((e,r)=>{let a=J(el,e.__scopePopover),s=R.useRef(!1),l=R.useRef(!1);return(0,t.jsx)(ed,{...e,ref:r,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:t=>{e.onCloseAutoFocus?.(t),t.defaultPrevented||(s.current||a.triggerRef.current?.focus(),t.preventDefault()),s.current=!1,l.current=!1},onInteractOutside:t=>{e.onInteractOutside?.(t),t.defaultPrevented||(s.current=!0,"pointerdown"===t.detail.originalEvent.type&&(l.current=!0));let r=t.target;a.triggerRef.current?.contains(r)&&t.preventDefault(),"focusin"===t.detail.originalEvent.type&&l.current&&t.preventDefault()}})}),ed=R.forwardRef((e,r)=>{let{__scopePopover:a,trapFocus:s,onOpenAutoFocus:l,onCloseAutoFocus:n,disableOutsidePointerEvents:i,onEscapeKeyDown:o,onPointerDownOutside:d,onFocusOutside:c,onInteractOutside:x,...m}=e,h=J(el,a),u=X(a);return(0,F.useFocusGuards)(),(0,t.jsx)(I.FocusScope,{asChild:!0,loop:!0,trapped:s,onMountAutoFocus:l,onUnmountAutoFocus:n,children:(0,t.jsx)(E.DismissableLayer,{asChild:!0,disableOutsidePointerEvents:i,onInteractOutside:x,onEscapeKeyDown:o,onPointerDownOutside:d,onFocusOutside:c,onDismiss:()=>h.onOpenChange(!1),children:(0,t.jsx)(H.Content,{"data-state":ex(h.open),role:"dialog",id:h.contentId,...u,...m,ref:r,style:{...m.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),ec="PopoverClose";function ex(e){return e?"open":"closed"}function em({...e}){return(0,t.jsx)(K,{"data-slot":"popover",...e})}function eh({...e}){return(0,t.jsx)(ee,{"data-slot":"popover-trigger",...e})}function eu({className:e,align:r="center",sideOffset:a=4,...l}){return(0,t.jsx)(es,{children:(0,t.jsx)(en,{"data-slot":"popover-content",align:r,sideOffset:a,className:(0,s.cn)("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-72 origin-(--radix-popover-content-transform-origin) rounded-md border p-4 shadow-md outline-hidden",e),...l})})}R.forwardRef((e,r)=>{let{__scopePopover:a,...s}=e,l=J(ec,a);return(0,t.jsx)(L.Primitive.button,{type:"button",...s,ref:r,onClick:(0,D.composeEventHandlers)(e.onClick,()=>l.onOpenChange(!1))})}).displayName=ec,R.forwardRef((e,r)=>{let{__scopePopover:a,...s}=e,l=X(a);return(0,t.jsx)(H.Arrow,{...l,...s,ref:r})}).displayName="PopoverArrow";var ep=e.i(22869);function eg({userName:e,unreadCount:r,onSearch:s}){let l=(0,a.useRouter)(),{t:n}=(0,g.useLanguage)(),[i,o]=(0,R.useState)(""),[d,c]=(0,R.useState)([]),[x,m]=(0,R.useState)(r||0);return(0,R.useEffect)(()=>{let e=()=>{let e=(0,P.getReportsFromStorage)().filter(e=>{let t=new Date(e.created_at);return(new Date().getTime()-t.getTime())/1e3/60<60}).map(e=>({id:e.id,title:`New Report: ${e.category||"Unknown"}`,message:e.complaint_text.slice(0,80)+"...",created_at:e.created_at,type:"new_report",severity:e.severity_level}));c(e),m(e.length)};e();let t=()=>{e()};return window.addEventListener("reportsUpdated",t),()=>window.removeEventListener("reportsUpdated",t)},[]),(0,t.jsx)("header",{className:"sticky top-0 z-40 border-b border-border bg-background",children:(0,t.jsxs)("div",{className:"flex h-16 items-center justify-between px-6",children:[(0,t.jsx)("div",{className:"flex items-center gap-4 flex-1 max-w-2xl",children:(0,t.jsxs)("form",{onSubmit:e=>{e.preventDefault(),s&&s(i)},className:"relative flex-1",children:[(0,t.jsx)(b,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,t.jsx)(y.Input,{placeholder:n("search.placeholder"),className:"pl-9",value:i,onChange:e=>o(e.target.value)})]})}),(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)(S,{}),(0,t.jsxs)(em,{children:[(0,t.jsx)(eh,{asChild:!0,children:(0,t.jsxs)(v.Button,{variant:"ghost",size:"icon",className:"relative",children:[(0,t.jsx)(j.Bell,{className:"h-5 w-5"}),x>0&&(0,t.jsx)(k.Badge,{className:"absolute -top-1 -right-1 h-5 w-5 flex items-center justify-center p-0 text-xs",children:x})]})}),(0,t.jsxs)(eu,{className:"w-80 p-0",align:"end",children:[(0,t.jsxs)("div",{className:"p-4 border-b",children:[(0,t.jsx)("h3",{className:"font-semibold",children:"Notifications"}),(0,t.jsxs)("p",{className:"text-xs text-muted-foreground",children:[x," new notifications"]})]}),(0,t.jsx)("div",{className:"max-h-96 overflow-y-auto",children:0===d.length?(0,t.jsx)("div",{className:"p-8 text-center text-sm text-muted-foreground",children:"No new notifications"}):d.map(e=>(0,t.jsx)("div",{className:"p-4 border-b hover:bg-muted/50 cursor-pointer transition-colors",onClick:()=>l.push(`/admin/reports/${e.id}`),children:(0,t.jsxs)("div",{className:"flex items-start gap-2",children:[(0,t.jsx)(j.Bell,{className:"h-4 w-4 text-primary mt-0.5"}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("p",{className:"text-sm font-medium",children:e.title}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground mt-1 line-clamp-2",children:e.message}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:new Date(e.created_at).toLocaleString()})]}),e.severity&&(0,t.jsx)(k.Badge,{variant:"secondary",className:"critical"===e.severity?"bg-red-500/10 text-red-700":"high"===e.severity?"bg-orange-500/10 text-orange-700":"bg-yellow-500/10 text-yellow-700",children:e.severity})]})},e.id))})]})]}),(0,t.jsxs)(C.DropdownMenu,{children:[(0,t.jsx)(C.DropdownMenuTrigger,{asChild:!0,children:(0,t.jsxs)(v.Button,{variant:"ghost",className:"gap-2",children:[(0,t.jsx)(w.User,{className:"h-5 w-5"}),(0,t.jsx)("span",{className:"hidden md:inline",children:e})]})}),(0,t.jsxs)(C.DropdownMenuContent,{align:"end",className:"w-56",children:[(0,t.jsx)(C.DropdownMenuLabel,{children:(0,t.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,t.jsx)("p",{className:"text-sm font-medium",children:e}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:n("admin.panel")})]})}),(0,t.jsx)(C.DropdownMenuSeparator,{}),(0,t.jsxs)(C.DropdownMenuItem,{onClick:()=>l.push("/"),className:"text-destructive",children:[(0,t.jsx)(N.LogOut,{className:"mr-2 h-4 w-4"}),n("action.logout")]})]})]}),(0,t.jsx)(ep.RoleSwitcher,{})]})]})})}e.s(["AdminTopNav",()=>eg],74095)},65073,e=>{"use strict";let t=(0,e.i(68385).default)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);e.s(["default",()=>t])},53454,e=>{"use strict";var t=e.i(65073);e.s(["X",()=>t.default])},94309,e=>{"use strict";var t=e.i(51537),r=e.i(11255),a=e.i(74095),s=e.i(98121),l=e.i(9704),n=e.i(80486),i=e.i(42584);let o=(0,e.i(68385).default)("Maximize2",[["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["polyline",{points:"9 21 3 21 3 15",key:"1avn1i"}],["line",{x1:"21",x2:"14",y1:"3",y2:"10",key:"ota7mn"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]);var d=e.i(53454),c=e.i(48489),x=e.i(58987);function m({reports:e,isExpanded:r=!1}){var a;let s=(0,x.useRef)(null),l=(0,x.useRef)(null),[n,i]=(0,x.useState)(null),[o,d]=(0,x.useState)({x:0,y:0}),[c,m]=(0,x.useState)(12),[h,u]=(0,x.useState)({lat:28.6139,lng:77.209}),[p,g]=(0,x.useState)(!0);(0,x.useEffect)(()=>{e.length>0&&u({lat:e.reduce((e,t)=>e+t.lat,0)/e.length,lng:e.reduce((e,t)=>e+t.lng,0)/e.length})},[e]),(0,x.useEffect)(()=>{if(!l.current||!s.current||!p)return;let t=l.current,r=t.getContext("2d");if(!r)return;let a=s.current.clientWidth,n=s.current.clientHeight;t.width=a,t.height=n,r.clearRect(0,0,a,n),e.forEach(e=>{let t=S(e.lat,e.lng);if(t.x<-100||t.x>a+100||t.y<-100||t.y>n+100)return;let s={low:.3,medium:.5,high:.7,critical:1}[e.severity],l=r.createRadialGradient(t.x,t.y,0,t.x,t.y,60);l.addColorStop(0,`rgba(255, 100, 100, ${.6*s})`),l.addColorStop(.5,`rgba(255, 150, 50, ${.3*s})`),l.addColorStop(1,"rgba(255, 200, 0, 0)"),r.fillStyle=l,r.fillRect(t.x-60,t.y-60,120,120)})},[e,c,h,p]);let f=(e,t,r)=>{let a=256*Math.pow(2,r),s=e*Math.PI/180,l=(1-Math.log(Math.tan(s)+1/Math.cos(s))/Math.PI)/2*a;return{x:(t+180)/360*a,y:l}},v={low:"#22c55e",medium:"#eab308",high:"#f97316",critical:"#ef4444"},y=s.current?.clientWidth||1200,j=s.current?.clientHeight||800,b=(a=h.lat,{x:Math.floor((h.lng+180)/360*Math.pow(2,c)),y:Math.floor((1-Math.log(Math.tan(a*Math.PI/180)+1/Math.cos(a*Math.PI/180))/Math.PI)/2*Math.pow(2,c))}),w=f(h.lat,h.lng,c),N=Math.ceil(y/256)+2,C=Math.ceil(j/256)+2,k=b.x-Math.floor(N/2),M=b.y-Math.floor(C/2),S=(e,t)=>{let r=f(e,t,c);return{x:r.x-w.x+y/2,y:r.y-w.y+j/2}};return(0,t.jsxs)("div",{ref:s,className:"relative w-full h-full bg-gray-200 overflow-hidden",onWheel:e=>{e.preventDefault();let t=e.deltaY>0?-1:1;m(e=>Math.max(10,Math.min(18,e+t)))},children:[(0,t.jsx)("div",{className:"absolute inset-0",style:{transform:`translate(${-(w.x%256)}px, ${-(w.y%256)}px)`},children:Array.from({length:C}).map((e,r)=>Array.from({length:N}).map((e,a)=>{let s=k+a,l=M+r,n=`https://tile.openstreetmap.org/${c}/${s}/${l}.png`;return(0,t.jsx)("img",{src:n||"/placeholder.svg",alt:"",className:"absolute pointer-events-none",style:{left:256*a,top:256*r,width:256,height:256},onError:e=>{e.target.style.backgroundColor="#e5e7eb"}},`${s}-${l}`)}))}),(0,t.jsx)("canvas",{ref:l,className:"absolute inset-0 pointer-events-none",style:{opacity:.6*!!p,mixBlendMode:"multiply",transition:"opacity 0.3s ease"}}),e.map(e=>{let r=S(e.lat,e.lng);return r.x<-50||r.x>y+50||r.y<-50||r.y>j+50?null:(0,t.jsx)("div",{className:"absolute transform -translate-x-1/2 -translate-y-full cursor-pointer transition-transform hover:scale-110",style:{left:r.x,top:r.y,zIndex:10},onMouseEnter:t=>{let r;return i(e),void((r=s.current?.getBoundingClientRect())&&d({x:t.clientX-r.left,y:t.clientY-r.top}))},onMouseLeave:()=>i(null),children:(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("div",{className:"w-8 h-8 rounded-full border-4 border-white shadow-lg flex items-center justify-center",style:{backgroundColor:v[e.severity]},children:(0,t.jsx)("svg",{className:"w-4 h-4 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:(0,t.jsx)("path",{fillRule:"evenodd",d:"M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z",clipRule:"evenodd"})})}),(0,t.jsx)("div",{className:"absolute left-1/2 top-full w-0 h-0 transform -translate-x-1/2",style:{borderLeft:"6px solid transparent",borderRight:"6px solid transparent",borderTop:`12px solid ${v[e.severity]}`}})]})},e.id)}),n&&(0,t.jsxs)("div",{className:"absolute bg-white rounded-lg shadow-xl p-4 pointer-events-none z-50 border border-gray-200",style:{left:o.x+20,top:o.y-60,maxWidth:"300px"},children:[(0,t.jsx)("h3",{className:"font-semibold text-sm mb-2",children:n.complaint}),(0,t.jsx)("p",{className:"text-xs text-gray-600 mb-2",children:n.address}),(0,t.jsxs)("p",{className:"text-xs text-gray-500 mb-2",children:["ğŸ“ ",n.lat.toFixed(5),", ",n.lng.toFixed(5)]}),(0,t.jsx)("span",{className:`inline-block px-2 py-1 rounded text-xs font-medium ${"critical"===n.severity?"bg-red-100 text-red-700":"high"===n.severity?"bg-orange-100 text-orange-700":"medium"===n.severity?"bg-yellow-100 text-yellow-700":"bg-green-100 text-green-700"}`,children:n.severity.toUpperCase()})]}),(0,t.jsxs)("div",{className:"absolute top-4 right-4 bg-white/95 backdrop-blur-sm p-3 rounded-lg shadow-lg space-y-2",children:[(0,t.jsx)("p",{className:"text-xs font-semibold mb-2",children:"Severity / à¤—à¤‚à¤­à¥€à¤°à¤¤à¤¾"}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"w-3 h-3 rounded-full bg-red-500"}),(0,t.jsx)("span",{className:"text-xs",children:"Critical"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"w-3 h-3 rounded-full bg-orange-500"}),(0,t.jsx)("span",{className:"text-xs",children:"High"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"w-3 h-3 rounded-full bg-yellow-500"}),(0,t.jsx)("span",{className:"text-xs",children:"Medium"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"w-3 h-3 rounded-full bg-green-500"}),(0,t.jsx)("span",{className:"text-xs",children:"Low"})]}),(0,t.jsx)("div",{className:"pt-2 border-t border-gray-200 mt-2",children:(0,t.jsxs)("button",{onClick:()=>g(!p),className:"text-xs text-primary hover:underline w-full text-left",children:[p?"Hide":"Show"," Heatmap"]})})]}),(0,t.jsxs)("div",{className:"absolute bottom-4 left-4 bg-white/95 backdrop-blur-sm p-3 rounded-lg shadow-lg",children:[(0,t.jsx)("p",{className:"text-sm font-semibold",children:"ğŸ“ Active Reports Map"}),(0,t.jsxs)("p",{className:"text-xs text-muted-foreground mt-1",children:[e.length," reports on map"]}),(0,t.jsxs)("p",{className:"text-xs text-muted-foreground mt-1",children:["Zoom Level: ",c]}),(0,t.jsxs)("p",{className:"text-xs text-muted-foreground mt-1",children:["Center: ",h.lat.toFixed(4),", ",h.lng.toFixed(4)]}),(0,t.jsxs)("div",{className:"flex gap-2 mt-2",children:[(0,t.jsx)("button",{onClick:()=>m(e=>Math.min(18,e+1)),className:"px-2 py-1 bg-primary text-primary-foreground rounded text-xs hover:bg-primary/90",children:"Zoom In"}),(0,t.jsx)("button",{onClick:()=>m(e=>Math.max(10,e-1)),className:"px-2 py-1 bg-primary text-primary-foreground rounded text-xs hover:bg-primary/90",children:"Zoom Out"}),(0,t.jsx)("button",{onClick:()=>{e.length>0?(u({lat:e.reduce((e,t)=>e+t.lat,0)/e.length,lng:e.reduce((e,t)=>e+t.lng,0)/e.length}),m(12)):(m(12),u({lat:28.6139,lng:77.209}))},className:"px-2 py-1 bg-secondary text-secondary-foreground rounded text-xs hover:bg-secondary/90",children:"Reset"})]})]})]})}var h=e.i(8673);function u(){let{t:e}=(0,c.useLanguage)(),[u,p]=(0,x.useState)(!1),[g,f]=(0,x.useState)(""),[v,y]=(0,x.useState)([]);(0,x.useEffect)(()=>{let e=()=>{y((0,h.getReportsFromStorage)().filter(e=>e.latitude&&e.longitude))};e();let t=()=>e();return window.addEventListener("reportsUpdated",t),()=>window.removeEventListener("reportsUpdated",t)},[]);let j=v.map(e=>({id:e.id,lat:e.latitude,lng:e.longitude,severity:e.severity_level||"medium",address:e.address||`${e.latitude}, ${e.longitude}`,complaint:e.complaint_text})),b=g?j.filter(e=>e.address.toLowerCase().includes(g.toLowerCase())||e.complaint.toLowerCase().includes(g.toLowerCase())):j,w={low:"bg-green-500/10 text-green-700",medium:"bg-yellow-500/10 text-yellow-700",high:"bg-orange-500/10 text-orange-700",critical:"bg-red-500/10 text-red-700"},N={total:b.length,critical:b.filter(e=>"critical"===e.severity).length,high:b.filter(e=>"high"===e.severity).length,medium:b.filter(e=>"medium"===e.severity).length,low:b.filter(e=>"low"===e.severity).length};return(0,t.jsxs)("div",{className:"flex min-h-screen",children:[(0,t.jsx)(r.AdminSidebar,{}),(0,t.jsxs)("div",{className:"flex-1 flex flex-col ml-64 overflow-y-auto",children:[(0,t.jsx)(a.AdminTopNav,{userName:"à¤¸à¥à¤¨à¥€à¤¤à¤¾ à¤®à¥‡à¤¹à¤¤à¤¾ / Sunita Mehta",onSearch:f}),(0,t.jsx)("main",{className:"flex-1 p-6 max-w-7xl w-full mx-auto",children:(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"text-center mx-auto",children:[(0,t.jsx)("h1",{className:"text-3xl font-bold",children:e("admin.map")}),(0,t.jsx)("p",{className:"text-muted-foreground mt-1",children:"Geographic view of all civic reports with heatmap"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:[(0,t.jsxs)(s.Card,{children:[(0,t.jsx)(s.CardHeader,{className:"pb-2",children:(0,t.jsx)(s.CardTitle,{className:"text-sm font-medium",children:"Total Reports"})}),(0,t.jsxs)(s.CardContent,{children:[(0,t.jsx)("div",{className:"text-2xl font-bold",children:N.total}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"On map"})]})]}),(0,t.jsxs)(s.Card,{className:"border-red-200 bg-red-50/50",children:[(0,t.jsx)(s.CardHeader,{className:"pb-2",children:(0,t.jsx)(s.CardTitle,{className:"text-sm font-medium text-red-700",children:"Critical"})}),(0,t.jsxs)(s.CardContent,{children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-red-700",children:N.critical}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"Urgent action"})]})]}),(0,t.jsxs)(s.Card,{className:"border-orange-200 bg-orange-50/50",children:[(0,t.jsx)(s.CardHeader,{className:"pb-2",children:(0,t.jsx)(s.CardTitle,{className:"text-sm font-medium text-orange-700",children:"High"})}),(0,t.jsxs)(s.CardContent,{children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-orange-700",children:N.high}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"Priority"})]})]}),(0,t.jsxs)(s.Card,{className:"border-yellow-200 bg-yellow-50/50",children:[(0,t.jsx)(s.CardHeader,{className:"pb-2",children:(0,t.jsx)(s.CardTitle,{className:"text-sm font-medium text-yellow-700",children:"Medium"})}),(0,t.jsxs)(s.CardContent,{children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-yellow-700",children:N.medium}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"Standard"})]})]}),(0,t.jsxs)(s.Card,{className:"border-green-200 bg-green-50/50",children:[(0,t.jsx)(s.CardHeader,{className:"pb-2",children:(0,t.jsx)(s.CardTitle,{className:"text-sm font-medium text-green-700",children:"Low"})}),(0,t.jsxs)(s.CardContent,{children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-green-700",children:N.low}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"Routine"})]})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,t.jsxs)(s.Card,{className:`${u?"fixed inset-4 z-50 lg:col-span-3":"lg:col-span-2"}`,children:[(0,t.jsxs)(s.CardHeader,{className:"flex flex-row items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(s.CardTitle,{children:"à¤°à¤¿à¤ªà¥‹à¤°à¥à¤Ÿ à¤®à¤¾à¤¨à¤šà¤¿à¤¤à¥à¤° / Reports Map with Heatmap"}),(0,t.jsx)(s.CardDescription,{children:"Interactive map showing report locations and issue density"})]}),(0,t.jsx)(n.Button,{variant:"outline",size:"icon",onClick:()=>p(!u),className:"flex-shrink-0",children:u?(0,t.jsx)(d.X,{className:"h-4 w-4"}):(0,t.jsx)(o,{className:"h-4 w-4"})})]}),(0,t.jsx)(s.CardContent,{children:(0,t.jsx)("div",{className:`${u?"h-[calc(100vh-12rem)]":"h-[600px]"} rounded-lg overflow-hidden`,children:(0,t.jsx)(m,{reports:b,isExpanded:u})})})]}),!u&&(0,t.jsxs)(s.Card,{children:[(0,t.jsxs)(s.CardHeader,{children:[(0,t.jsx)(s.CardTitle,{children:"à¤¸à¥à¤¥à¤¾à¤¨ à¤•à¥‡ à¤…à¤¨à¥à¤¸à¤¾à¤° à¤°à¤¿à¤ªà¥‹à¤°à¥à¤Ÿ / Reports by Location"}),(0,t.jsxs)(s.CardDescription,{children:[b.length," active reports"]})]}),(0,t.jsx)(s.CardContent,{children:(0,t.jsx)("div",{className:"space-y-3 max-h-[600px] overflow-y-auto",children:0===b.length?(0,t.jsxs)("div",{className:"text-center py-8 text-sm text-muted-foreground",children:[(0,t.jsx)(i.MapPin,{className:"h-12 w-12 mx-auto mb-3 text-muted-foreground/50"}),(0,t.jsx)("p",{children:"No reports with location data yet"}),(0,t.jsx)("p",{className:"text-xs mt-2",children:"Reports will appear here once citizens submit issues"})]}):b.map(e=>(0,t.jsxs)("a",{href:`/admin/reports/${e.id}`,className:"flex items-start gap-3 p-3 rounded-lg border border-border hover:bg-muted/50 transition-colors",children:[(0,t.jsx)(i.MapPin,{className:"h-5 w-5 text-primary mt-0.5 flex-shrink-0"}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("p",{className:"font-medium text-sm line-clamp-1",children:e.complaint}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground mt-1 line-clamp-2",children:e.address}),(0,t.jsxs)("p",{className:"text-xs text-muted-foreground mt-1 font-mono",children:["ğŸ“ ",e.lat.toFixed(5),", ",e.lng.toFixed(5)]}),(0,t.jsx)(l.Badge,{variant:"secondary",className:`mt-2 ${w[e.severity]}`,children:e.severity})]})]},e.id))})})]})]})]})})]})]})}e.s(["default",()=>u],94309)}]);