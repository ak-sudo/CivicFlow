(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,42972,e=>{"use strict";var t=e.i(51537),r=e.i(52299);function s({className:e,type:s,...a}){return(0,t.jsx)("input",{type:s,"data-slot":"input",className:(0,r.cn)("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",e),...a})}e.s(["Input",()=>s])},82397,e=>{"use strict";let t=(0,e.i(68385).default)("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);e.s(["FileText",()=>t],82397)},9704,e=>{"use strict";var t=e.i(51537),r=e.i(67746),s=e.i(37705),a=e.i(52299);let n=(0,s.cva)("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function i({className:e,variant:s,asChild:i=!1,...o}){let d=i?r.Slot:"span";return(0,t.jsx)(d,{"data-slot":"badge",className:(0,a.cn)(n({variant:s}),e),...o})}e.s(["Badge",()=>i])},98121,e=>{"use strict";var t=e.i(51537),r=e.i(52299);function s({className:e,...s}){return(0,t.jsx)("div",{"data-slot":"card",className:(0,r.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",e),...s})}function a({className:e,...s}){return(0,t.jsx)("div",{"data-slot":"card-header",className:(0,r.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",e),...s})}function n({className:e,...s}){return(0,t.jsx)("div",{"data-slot":"card-title",className:(0,r.cn)("leading-none font-semibold",e),...s})}function i({className:e,...s}){return(0,t.jsx)("div",{"data-slot":"card-description",className:(0,r.cn)("text-muted-foreground text-sm",e),...s})}function o({className:e,...s}){return(0,t.jsx)("div",{"data-slot":"card-content",className:(0,r.cn)("px-6",e),...s})}e.s(["Card",()=>s,"CardContent",()=>o,"CardDescription",()=>i,"CardHeader",()=>a,"CardTitle",()=>n])},70350,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var s={default:function(){return c},getImageProps:function(){return l}};for(var a in s)Object.defineProperty(r,a,{enumerable:!0,get:s[a]});let n=e.r(79364),i=e.r(76424),o=e.r(95823),d=n._(e.r(49354));function l(e){let{props:t}=(0,i.getImgProps)(e,{defaultLoader:d.default,imgConf:{deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[32,48,64,96,128,256,384],qualities:[75],path:"/_next/image",loader:"default",dangerouslyAllowSVG:!1,unoptimized:!0}});for(let[e,r]of Object.entries(t))void 0===r&&delete t[e];return{props:t}}let c=o.Image},3908,(e,t,r)=>{t.exports=e.r(70350)},32749,3305,e=>{"use strict";var t=e.i(68385);let r=(0,t.default)("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);e.s(["Bell",()=>r],32749);let s=(0,t.default)("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);e.s(["LogOut",()=>s],3305)},8673,e=>{"use strict";let t="civicflow_reports";function r(){try{let e=localStorage.getItem(t);return e?JSON.parse(e):[]}catch{return[]}}function s(e){try{let s=r();e.timeline||(e.timeline=[{id:`timeline_${Date.now()}`,action:"Report submitted",created_at:new Date().toISOString(),actor_name:e.profiles?.full_name||"Citizen",details:{category:e.category,severity:e.severity_level,ai_confidence:e.ai_analysis?.category_confidence}}]),s.unshift(e),localStorage.setItem(t,JSON.stringify(s)),window.dispatchEvent(new CustomEvent("reportsUpdated",{detail:{reports:s}}))}catch(e){console.error("Failed to save report to localStorage:",e)}}function a(e,s){try{let a=r(),n=a.findIndex(t=>t.id===e);if(-1!==n){if(s.status&&s.status!==a[n].status){let e={id:`timeline_${Date.now()}`,action:`Status changed to ${s.status}`,created_at:new Date().toISOString(),actor_name:"completed"===s.status?"Worker":"System"};a[n].timeline=a[n].timeline||[],a[n].timeline.unshift(e)}("completed"===s.status||"verified"===s.status)&&(s.verified_at=new Date().toISOString()),a[n]={...a[n],...s,updated_at:new Date().toISOString()},localStorage.setItem(t,JSON.stringify(a)),window.dispatchEvent(new CustomEvent("reportsUpdated",{detail:{reports:a}}))}}catch(e){console.error("Failed to update report in localStorage:",e)}}function n(e){return r().find(t=>t.id===e)||null}e.s(["getReportById",()=>n,"getReportsFromStorage",()=>r,"saveReportToStorage",()=>s,"updateReportInStorage",()=>a])},85258,e=>{"use strict";let t=(0,e.i(68385).default)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);e.s(["AlertCircle",()=>t],85258)},11255,7455,26668,28606,15887,74095,e=>{"use strict";var t=e.i(51537),r=e.i(43638),s=e.i(16221),a=e.i(52299),n=e.i(3908),i=e.i(68385);let o=(0,i.default)("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);var d=e.i(82397);let l=(0,i.default)("Map",[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]]);var c=e.i(85258),m=e.i(95658);let u=(0,i.default)("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);e.s(["Building2",()=>u],7455);let x=(0,i.default)("ChartColumn",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);e.s(["BarChart3",()=>x],26668);let p=(0,i.default)("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);e.s(["Settings",()=>p],28606);let h=(0,i.default)("ScrollText",[["path",{d:"M15 12h-5",key:"r7krc0"}],["path",{d:"M15 8h-5",key:"1khuty"}],["path",{d:"M19 17V5a2 2 0 0 0-2-2H4",key:"zz82l3"}],["path",{d:"M8 21h12a2 2 0 0 0 2-2v-1a1 1 0 0 0-1-1H11a1 1 0 0 0-1 1v1a2 2 0 1 1-4 0V5a2 2 0 1 0-4 0v2a1 1 0 0 0 1 1h3",key:"1ph1d7"}]]);e.s(["ScrollText",()=>h],15887);var f=e.i(48489);function g(){let e=(0,s.usePathname)(),{t:i}=(0,f.useLanguage)(),g=[{name:i("admin.dashboard"),href:"/admin/dashboard",icon:o},{name:i("admin.reports"),href:"/admin/reports",icon:d.FileText},{name:i("admin.map"),href:"/admin/map",icon:l},{name:i("admin.review"),href:"/admin/review",icon:c.AlertCircle},{name:i("admin.workers"),href:"/admin/workers",icon:m.Users},{name:i("admin.departments"),href:"/admin/departments",icon:u},{name:i("admin.analytics"),href:"/admin/analytics",icon:x},{name:i("admin.audit"),href:"/admin/audit",icon:h},{name:i("admin.settings"),href:"/admin/settings",icon:p}];return(0,t.jsxs)("aside",{className:"hidden lg:flex flex-col w-64 pb-3 bg-muted/30 fixed h-screen overflow-y-auto",children:[(0,t.jsx)("div",{className:"p-6",children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(n.default,{src:"/civiflow-logo.png",alt:"CivicFlow Logo",width:36,height:36,className:"object-contain"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-bold text-lg",children:i("app.name")}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:i("admin.panel")})]})]})}),(0,t.jsx)("nav",{className:"flex-1 px-4 space-y-1",children:g.map(s=>{let n=e===s.href;return(0,t.jsxs)(r.default,{href:s.href,className:(0,a.cn)("flex items-center gap-3 px-3 py-2 rounded-lg text-sm font-medium transition-colors",n?"bg-primary text-primary-foreground":"text-muted-foreground hover:bg-muted hover:text-foreground"),children:[(0,t.jsx)(s.icon,{className:"h-5 w-5"}),s.name]},s.href)})})]})}e.s(["AdminSidebar",()=>g],11255);var v=e.i(80486),j=e.i(42972),y=e.i(32749);let b=(0,i.default)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);var w=e.i(87672),N=e.i(3305),C=e.i(14782),k=e.i(9704);let S=(0,i.default)("Languages",[["path",{d:"m5 8 6 6",key:"1wu5hv"}],["path",{d:"m4 14 6-6 2-3",key:"1k1g8d"}],["path",{d:"M2 5h12",key:"or177f"}],["path",{d:"M7 2h1",key:"1t2jsx"}],["path",{d:"m22 22-5-10-5 10",key:"don7ne"}],["path",{d:"M14 18h6",key:"1m8k6r"}]]);function M(){let{language:e,setLanguage:r}=(0,f.useLanguage)();return(0,t.jsxs)(C.DropdownMenu,{children:[(0,t.jsx)(C.DropdownMenuTrigger,{asChild:!0,children:(0,t.jsx)(v.Button,{variant:"ghost",size:"icon",className:"relative",children:(0,t.jsx)(S,{className:"h-5 w-5"})})}),(0,t.jsxs)(C.DropdownMenuContent,{align:"end",children:[(0,t.jsx)(C.DropdownMenuItem,{onClick:()=>r("en"),className:"en"===e?"bg-accent":"",children:"English"}),(0,t.jsx)(C.DropdownMenuItem,{onClick:()=>r("hi"),className:"hi"===e?"bg-accent":"",children:"हिंदी (Hindi)"})]})]})}var _=e.i(58987),T=e.i(8673),D=e.i(63565),I=e.i(2009),R=e.i(21359),A=e.i(16216),P=e.i(39858),O=e.i(58008),F=e.i(81701),H=e.i(85617),E=e.i(51550),U=e.i(84348),V=e.i(84085),z=e.i(67746),L=e.i(4541),B=e.i(26889),q=e.i(26452),$="Popover",[J,Z]=(0,R.createContextScope)($,[H.createPopperScope]),K=(0,H.createPopperScope)(),[G,W]=J($),Q=e=>{let{__scopePopover:r,children:s,open:a,defaultOpen:n,onOpenChange:i,modal:o=!1}=e,d=K(r),l=_.useRef(null),[c,m]=_.useState(!1),[u=!1,x]=(0,L.useControllableState)({prop:a,defaultProp:n,onChange:i});return(0,t.jsx)(H.Root,{...d,children:(0,t.jsx)(G,{scope:r,contentId:(0,F.useId)(),triggerRef:l,open:u,onOpenChange:x,onOpenToggle:_.useCallback(()=>x(e=>!e),[x]),hasCustomAnchor:c,onCustomAnchorAdd:_.useCallback(()=>m(!0),[]),onCustomAnchorRemove:_.useCallback(()=>m(!1),[]),modal:o,children:s})})};Q.displayName=$;var X="PopoverAnchor";_.forwardRef((e,r)=>{let{__scopePopover:s,...a}=e,n=W(X,s),i=K(s),{onCustomAnchorAdd:o,onCustomAnchorRemove:d}=n;return _.useEffect(()=>(o(),()=>d()),[o,d]),(0,t.jsx)(H.Anchor,{...i,...a,ref:r})}).displayName=X;var Y="PopoverTrigger",ee=_.forwardRef((e,r)=>{let{__scopePopover:s,...a}=e,n=W(Y,s),i=K(s),o=(0,I.useComposedRefs)(r,n.triggerRef),d=(0,t.jsx)(V.Primitive.button,{type:"button","aria-haspopup":"dialog","aria-expanded":n.open,"aria-controls":n.contentId,"data-state":em(n.open),...a,ref:o,onClick:(0,D.composeEventHandlers)(e.onClick,n.onOpenToggle)});return n.hasCustomAnchor?d:(0,t.jsx)(H.Anchor,{asChild:!0,...i,children:d})});ee.displayName=Y;var et="PopoverPortal",[er,es]=J(et,{forceMount:void 0}),ea=e=>{let{__scopePopover:r,forceMount:s,children:a,container:n}=e,i=W(et,r);return(0,t.jsx)(er,{scope:r,forceMount:s,children:(0,t.jsx)(U.Presence,{present:s||i.open,children:(0,t.jsx)(E.Portal,{asChild:!0,container:n,children:a})})})};ea.displayName=et;var en="PopoverContent",ei=_.forwardRef((e,r)=>{let s=es(en,e.__scopePopover),{forceMount:a=s.forceMount,...n}=e,i=W(en,e.__scopePopover);return(0,t.jsx)(U.Presence,{present:a||i.open,children:i.modal?(0,t.jsx)(eo,{...n,ref:r}):(0,t.jsx)(ed,{...n,ref:r})})});ei.displayName=en;var eo=_.forwardRef((e,r)=>{let s=W(en,e.__scopePopover),a=_.useRef(null),n=(0,I.useComposedRefs)(r,a),i=_.useRef(!1);return _.useEffect(()=>{let e=a.current;if(e)return(0,B.hideOthers)(e)},[]),(0,t.jsx)(q.RemoveScroll,{as:z.Slot,allowPinchZoom:!0,children:(0,t.jsx)(el,{...e,ref:n,trapFocus:s.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:(0,D.composeEventHandlers)(e.onCloseAutoFocus,e=>{e.preventDefault(),i.current||s.triggerRef.current?.focus()}),onPointerDownOutside:(0,D.composeEventHandlers)(e.onPointerDownOutside,e=>{let t=e.detail.originalEvent,r=0===t.button&&!0===t.ctrlKey;i.current=2===t.button||r},{checkForDefaultPrevented:!1}),onFocusOutside:(0,D.composeEventHandlers)(e.onFocusOutside,e=>e.preventDefault(),{checkForDefaultPrevented:!1})})})}),ed=_.forwardRef((e,r)=>{let s=W(en,e.__scopePopover),a=_.useRef(!1),n=_.useRef(!1);return(0,t.jsx)(el,{...e,ref:r,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:t=>{e.onCloseAutoFocus?.(t),t.defaultPrevented||(a.current||s.triggerRef.current?.focus(),t.preventDefault()),a.current=!1,n.current=!1},onInteractOutside:t=>{e.onInteractOutside?.(t),t.defaultPrevented||(a.current=!0,"pointerdown"===t.detail.originalEvent.type&&(n.current=!0));let r=t.target;s.triggerRef.current?.contains(r)&&t.preventDefault(),"focusin"===t.detail.originalEvent.type&&n.current&&t.preventDefault()}})}),el=_.forwardRef((e,r)=>{let{__scopePopover:s,trapFocus:a,onOpenAutoFocus:n,onCloseAutoFocus:i,disableOutsidePointerEvents:o,onEscapeKeyDown:d,onPointerDownOutside:l,onFocusOutside:c,onInteractOutside:m,...u}=e,x=W(en,s),p=K(s);return(0,P.useFocusGuards)(),(0,t.jsx)(O.FocusScope,{asChild:!0,loop:!0,trapped:a,onMountAutoFocus:n,onUnmountAutoFocus:i,children:(0,t.jsx)(A.DismissableLayer,{asChild:!0,disableOutsidePointerEvents:o,onInteractOutside:m,onEscapeKeyDown:d,onPointerDownOutside:l,onFocusOutside:c,onDismiss:()=>x.onOpenChange(!1),children:(0,t.jsx)(H.Content,{"data-state":em(x.open),role:"dialog",id:x.contentId,...p,...u,ref:r,style:{...u.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),ec="PopoverClose";function em(e){return e?"open":"closed"}function eu({...e}){return(0,t.jsx)(Q,{"data-slot":"popover",...e})}function ex({...e}){return(0,t.jsx)(ee,{"data-slot":"popover-trigger",...e})}function ep({className:e,align:r="center",sideOffset:s=4,...n}){return(0,t.jsx)(ea,{children:(0,t.jsx)(ei,{"data-slot":"popover-content",align:r,sideOffset:s,className:(0,a.cn)("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-72 origin-(--radix-popover-content-transform-origin) rounded-md border p-4 shadow-md outline-hidden",e),...n})})}_.forwardRef((e,r)=>{let{__scopePopover:s,...a}=e,n=W(ec,s);return(0,t.jsx)(V.Primitive.button,{type:"button",...a,ref:r,onClick:(0,D.composeEventHandlers)(e.onClick,()=>n.onOpenChange(!1))})}).displayName=ec,_.forwardRef((e,r)=>{let{__scopePopover:s,...a}=e,n=K(s);return(0,t.jsx)(H.Arrow,{...n,...a,ref:r})}).displayName="PopoverArrow";var eh=e.i(22869);function ef({userName:e,unreadCount:r,onSearch:a}){let n=(0,s.useRouter)(),{t:i}=(0,f.useLanguage)(),[o,d]=(0,_.useState)(""),[l,c]=(0,_.useState)([]),[m,u]=(0,_.useState)(r||0);return(0,_.useEffect)(()=>{let e=()=>{let e=(0,T.getReportsFromStorage)().filter(e=>{let t=new Date(e.created_at);return(new Date().getTime()-t.getTime())/1e3/60<60}).map(e=>({id:e.id,title:`New Report: ${e.category||"Unknown"}`,message:e.complaint_text.slice(0,80)+"...",created_at:e.created_at,type:"new_report",severity:e.severity_level}));c(e),u(e.length)};e();let t=()=>{e()};return window.addEventListener("reportsUpdated",t),()=>window.removeEventListener("reportsUpdated",t)},[]),(0,t.jsx)("header",{className:"sticky top-0 z-40 border-b border-border bg-background",children:(0,t.jsxs)("div",{className:"flex h-16 items-center justify-between px-6",children:[(0,t.jsx)("div",{className:"flex items-center gap-4 flex-1 max-w-2xl",children:(0,t.jsxs)("form",{onSubmit:e=>{e.preventDefault(),a&&a(o)},className:"relative flex-1",children:[(0,t.jsx)(b,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,t.jsx)(j.Input,{placeholder:i("search.placeholder"),className:"pl-9",value:o,onChange:e=>d(e.target.value)})]})}),(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)(M,{}),(0,t.jsxs)(eu,{children:[(0,t.jsx)(ex,{asChild:!0,children:(0,t.jsxs)(v.Button,{variant:"ghost",size:"icon",className:"relative",children:[(0,t.jsx)(y.Bell,{className:"h-5 w-5"}),m>0&&(0,t.jsx)(k.Badge,{className:"absolute -top-1 -right-1 h-5 w-5 flex items-center justify-center p-0 text-xs",children:m})]})}),(0,t.jsxs)(ep,{className:"w-80 p-0",align:"end",children:[(0,t.jsxs)("div",{className:"p-4 border-b",children:[(0,t.jsx)("h3",{className:"font-semibold",children:"Notifications"}),(0,t.jsxs)("p",{className:"text-xs text-muted-foreground",children:[m," new notifications"]})]}),(0,t.jsx)("div",{className:"max-h-96 overflow-y-auto",children:0===l.length?(0,t.jsx)("div",{className:"p-8 text-center text-sm text-muted-foreground",children:"No new notifications"}):l.map(e=>(0,t.jsx)("div",{className:"p-4 border-b hover:bg-muted/50 cursor-pointer transition-colors",onClick:()=>n.push(`/admin/reports/${e.id}`),children:(0,t.jsxs)("div",{className:"flex items-start gap-2",children:[(0,t.jsx)(y.Bell,{className:"h-4 w-4 text-primary mt-0.5"}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("p",{className:"text-sm font-medium",children:e.title}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground mt-1 line-clamp-2",children:e.message}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:new Date(e.created_at).toLocaleString()})]}),e.severity&&(0,t.jsx)(k.Badge,{variant:"secondary",className:"critical"===e.severity?"bg-red-500/10 text-red-700":"high"===e.severity?"bg-orange-500/10 text-orange-700":"bg-yellow-500/10 text-yellow-700",children:e.severity})]})},e.id))})]})]}),(0,t.jsxs)(C.DropdownMenu,{children:[(0,t.jsx)(C.DropdownMenuTrigger,{asChild:!0,children:(0,t.jsxs)(v.Button,{variant:"ghost",className:"gap-2",children:[(0,t.jsx)(w.User,{className:"h-5 w-5"}),(0,t.jsx)("span",{className:"hidden md:inline",children:e})]})}),(0,t.jsxs)(C.DropdownMenuContent,{align:"end",className:"w-56",children:[(0,t.jsx)(C.DropdownMenuLabel,{children:(0,t.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,t.jsx)("p",{className:"text-sm font-medium",children:e}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:i("admin.panel")})]})}),(0,t.jsx)(C.DropdownMenuSeparator,{}),(0,t.jsxs)(C.DropdownMenuItem,{onClick:()=>n.push("/"),className:"text-destructive",children:[(0,t.jsx)(N.LogOut,{className:"mr-2 h-4 w-4"}),i("action.logout")]})]})]}),(0,t.jsx)(eh.RoleSwitcher,{})]})]})})}e.s(["AdminTopNav",()=>ef],74095)},9803,e=>{"use strict";let t=(0,e.i(68385).default)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);e.s(["Clock",()=>t],9803)},32617,e=>{"use strict";let t=(0,e.i(68385).default)("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);e.s(["CheckCircle2",()=>t],32617)},87571,e=>{"use strict";let t=(0,e.i(68385).default)("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);e.s(["TrendingUp",()=>t],87571)},15876,e=>{"use strict";let t=(0,e.i(68385).default)("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);e.s(["AlertTriangle",()=>t],15876)},17296,8051,75442,e=>{"use strict";var t=e.i(68385);let r=(0,t.default)("ThumbsUp",[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2a3.13 3.13 0 0 1 3 3.88Z",key:"emmmcr"}]]);e.s(["ThumbsUp",()=>r],17296);let s=(0,t.default)("ThumbsDown",[["path",{d:"M17 14V2",key:"8ymqnk"}],["path",{d:"M9 18.12 10 14H4.17a2 2 0 0 1-1.92-2.56l2.33-8A2 2 0 0 1 6.5 2H20a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-2.76a2 2 0 0 0-1.79 1.11L12 22a3.13 3.13 0 0 1-3-3.88Z",key:"m61m77"}]]);e.s(["ThumbsDown",()=>s],8051);let a="civicflow_civicbook_votes";function n(e,t,r,s){let a=(r-e)*Math.PI/180,n=(s-t)*Math.PI/180,i=Math.sin(a/2)*Math.sin(a/2)+Math.cos(e*Math.PI/180)*Math.cos(r*Math.PI/180)*Math.sin(n/2)*Math.sin(n/2);return 2*Math.atan2(Math.sqrt(i),Math.sqrt(1-i))*6371}function i(){try{let e=localStorage.getItem(a);return e?JSON.parse(e):[]}catch{return[]}}function o(e){try{let t=i().filter(t=>t.reportId!==e.reportId||t.userId!==e.userId);t.push(e),localStorage.setItem(a,JSON.stringify(t)),window.dispatchEvent(new CustomEvent("civicbookVotesUpdated",{detail:{votes:t}}))}catch(e){console.error("Failed to save vote:",e)}}function d(e,t){try{let r=i().filter(r=>r.reportId!==e||r.userId!==t);localStorage.setItem(a,JSON.stringify(r)),window.dispatchEvent(new CustomEvent("civicbookVotesUpdated",{detail:{votes:r}}))}catch(e){console.error("Failed to remove vote:",e)}}function l(e){let t=i().filter(t=>t.reportId===e);return{upvotes:t.filter(e=>"upvote"===e.voteType).length,downvotes:t.filter(e=>"downvote"===e.voteType).length}}function c(e,t){let r=i().find(r=>r.reportId===e&&r.userId===t);return r?r.voteType:null}function m(){let e=i(),t=new Map;return e.forEach(e=>{t.has(e.reportId)||t.set(e.reportId,{upvotes:0,downvotes:0});let r=t.get(e.reportId);"upvote"===e.voteType?r.upvotes++:r.downvotes++}),t}e.s(["calculateDistance",()=>n,"getReportVotingStats",()=>m,"getUserVoteForReport",()=>c,"getVotesForReport",()=>l,"removeVoteFromStorage",()=>d,"saveVoteToStorage",()=>o],75442)},38157,e=>{"use strict";var t=e.i(51537),r=e.i(11255),s=e.i(74095),a=e.i(98121),n=e.i(82397),i=e.i(32617),o=e.i(9803),d=e.i(15876),l=e.i(87571),c=e.i(95658),m=e.i(17296),u=e.i(8051),x=e.i(58987),p=e.i(8673),h=e.i(75442),f=e.i(9704);function g(){let[e,g]=(0,x.useState)([]),[v,j]=(0,x.useState)(new Map);(0,x.useEffect)(()=>{y();let e=()=>{y()};return window.addEventListener("reportsUpdated",e),window.addEventListener("civicbookVotesUpdated",e),()=>{window.removeEventListener("reportsUpdated",e),window.removeEventListener("civicbookVotesUpdated",e)}},[]);let y=()=>{g((0,p.getReportsFromStorage)()),j((0,h.getReportVotingStats)())},b=e.length,w=e.filter(e=>!["completed","verified"].includes(e.status)).length,N=e.filter(e=>["completed","verified"].includes(e.status)&&e.updated_at&&new Date(e.updated_at).toDateString()===new Date().toDateString()).length,C=e.filter(e=>e.needs_human_review).length,k=Array.from(v.values()).reduce((e,t)=>e+t.upvotes+t.downvotes,0),S=Array.from(v.values()).reduce((e,t)=>e+t.upvotes,0),M=Array.from(v.values()).reduce((e,t)=>e+t.downvotes,0),_=Array.from(v.entries()).filter(([e,t])=>t.upvotes>2).length,T=e.slice(0,5).map(e=>({...e,votes:v.get(e.id)||{upvotes:0,downvotes:0},communityScore:(v.get(e.id)?.upvotes||0)-(v.get(e.id)?.downvotes||0)})),D=e.map(e=>{let t=v.get(e.id)||{upvotes:0,downvotes:0};return{...e,votes:t,communityScore:t.upvotes-t.downvotes}}).filter(e=>e.communityScore>0).sort((e,t)=>t.communityScore-e.communityScore).slice(0,5);return(0,t.jsxs)("div",{className:"flex min-h-screen",children:[(0,t.jsx)(r.AdminSidebar,{}),(0,t.jsxs)("div",{className:"flex-1 flex flex-col ml-64 overflow-y-auto",children:[(0,t.jsx)(s.AdminTopNav,{userName:"Demo Admin"}),(0,t.jsxs)("main",{className:"flex-1 p-6 space-y-6 max-w-7xl w-full mx-auto",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold",children:"Dashboard"}),(0,t.jsx)("p",{className:"text-muted-foreground mt-1",children:"Overview of all civic reports and system metrics"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,t.jsxs)(a.Card,{children:[(0,t.jsxs)(a.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,t.jsx)(a.CardTitle,{className:"text-sm font-medium",children:"Total Open Reports"}),(0,t.jsx)(n.FileText,{className:"h-4 w-4 text-muted-foreground"})]}),(0,t.jsxs)(a.CardContent,{children:[(0,t.jsx)("div",{className:"text-2xl font-bold",children:w}),(0,t.jsxs)("p",{className:"text-xs text-muted-foreground",children:[b," total • ",b>0?Math.round(w/b*100):0,"% open"]})]})]}),(0,t.jsxs)(a.Card,{children:[(0,t.jsxs)(a.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,t.jsx)(a.CardTitle,{className:"text-sm font-medium",children:"Resolved Today"}),(0,t.jsx)(i.CheckCircle2,{className:"h-4 w-4 text-muted-foreground"})]}),(0,t.jsxs)(a.CardContent,{children:[(0,t.jsx)("div",{className:"text-2xl font-bold",children:N}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Verified and completed"})]})]}),(0,t.jsxs)(a.Card,{children:[(0,t.jsxs)(a.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,t.jsx)(a.CardTitle,{className:"text-sm font-medium",children:"Avg Resolution Time"}),(0,t.jsx)(o.Clock,{className:"h-4 w-4 text-muted-foreground"})]}),(0,t.jsxs)(a.CardContent,{children:[(0,t.jsxs)("div",{className:"text-2xl font-bold",children:["24","h"]}),(0,t.jsxs)("p",{className:"text-xs text-muted-foreground",children:[(0,t.jsx)(l.TrendingUp,{className:"inline h-3 w-3 text-green-500"})," Based on completed reports"]})]})]}),(0,t.jsxs)(a.Card,{children:[(0,t.jsxs)(a.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,t.jsx)(a.CardTitle,{className:"text-sm font-medium",children:"Needs Human Review"}),(0,t.jsx)(d.AlertTriangle,{className:"h-4 w-4 text-muted-foreground"})]}),(0,t.jsxs)(a.CardContent,{children:[(0,t.jsx)("div",{className:"text-2xl font-bold",children:C}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"AI flagged for review"})]})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,t.jsxs)(a.Card,{className:"border-2 border-accent/20",children:[(0,t.jsxs)(a.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,t.jsx)(a.CardTitle,{className:"text-sm font-medium",children:"Community Votes"}),(0,t.jsx)(c.Users,{className:"h-4 w-4 text-accent"})]}),(0,t.jsxs)(a.CardContent,{children:[(0,t.jsx)("div",{className:"text-2xl font-bold",children:k}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Total community engagement"})]})]}),(0,t.jsxs)(a.Card,{className:"border-2 border-green-500/20",children:[(0,t.jsxs)(a.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,t.jsx)(a.CardTitle,{className:"text-sm font-medium",children:"Validated Issues"}),(0,t.jsx)(m.ThumbsUp,{className:"h-4 w-4 text-green-500"})]}),(0,t.jsxs)(a.CardContent,{children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:S}),(0,t.jsxs)("p",{className:"text-xs text-muted-foreground",children:[_," reports with 3+ upvotes"]})]})]}),(0,t.jsxs)(a.Card,{className:"border-2 border-red-500/20",children:[(0,t.jsxs)(a.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,t.jsx)(a.CardTitle,{className:"text-sm font-medium",children:"Flagged as Fake"}),(0,t.jsx)(u.ThumbsDown,{className:"h-4 w-4 text-red-500"})]}),(0,t.jsxs)(a.CardContent,{children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-red-600 dark:text-red-400",children:M}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Community reported as fake"})]})]})]}),D.length>0&&(0,t.jsxs)(a.Card,{className:"border-2 border-accent/30",children:[(0,t.jsxs)(a.CardHeader,{children:[(0,t.jsxs)(a.CardTitle,{className:"flex items-center gap-2",children:[(0,t.jsx)(l.TrendingUp,{className:"h-5 w-5 text-accent"}),"Top Community-Validated Issues"]}),(0,t.jsx)(a.CardDescription,{children:"Issues with highest community verification scores"})]}),(0,t.jsx)(a.CardContent,{children:(0,t.jsx)("div",{className:"space-y-4",children:D.map(e=>(0,t.jsxs)("a",{href:`/admin/reports/${e.id}`,className:"flex items-start gap-4 p-4 rounded-lg border border-border hover:bg-muted/50 transition-colors",children:[e.report_images&&e.report_images[0]?(0,t.jsx)("img",{src:e.report_images[0].image_url||"/placeholder.svg",alt:"Report",className:"w-16 h-16 rounded-md object-cover"}):(0,t.jsx)("div",{className:"w-16 h-16 rounded-md bg-muted flex items-center justify-center",children:(0,t.jsx)(n.FileText,{className:"h-6 w-6 text-muted-foreground"})}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsxs)("div",{className:"flex items-start justify-between gap-2",children:[(0,t.jsx)("p",{className:"font-medium line-clamp-2",children:e.complaint_text}),(0,t.jsxs)(f.Badge,{className:"bg-accent shrink-0",children:["+",e.communityScore," Score"]})]}),(0,t.jsxs)("p",{className:"text-sm text-muted-foreground mt-1",children:[e.profiles?.full_name||"Anonymous"," • ",e.location]}),(0,t.jsxs)("div",{className:"mt-2 flex gap-3 items-center",children:[(0,t.jsxs)("div",{className:"flex items-center gap-1 text-sm",children:[(0,t.jsx)(m.ThumbsUp,{className:"h-4 w-4 text-green-500"}),(0,t.jsx)("span",{className:"font-semibold text-green-600 dark:text-green-400",children:e.votes.upvotes})]}),(0,t.jsxs)("div",{className:"flex items-center gap-1 text-sm",children:[(0,t.jsx)(u.ThumbsDown,{className:"h-4 w-4 text-red-500"}),(0,t.jsx)("span",{className:"font-semibold text-red-600 dark:text-red-400",children:e.votes.downvotes})]}),(0,t.jsx)("span",{className:`text-xs px-2 py-1 rounded ${"critical"===e.severity_level?"bg-red-100 dark:bg-red-900 text-red-800 dark:text-red-200":"high"===e.severity_level?"bg-orange-100 dark:bg-orange-900 text-orange-800 dark:text-orange-200":"bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200"}`,children:e.severity_level?.toUpperCase()})]})]})]},e.id))})})]}),(0,t.jsxs)(a.Card,{children:[(0,t.jsxs)(a.CardHeader,{children:[(0,t.jsx)(a.CardTitle,{children:"Recent Reports"}),(0,t.jsx)(a.CardDescription,{children:"Latest submissions from citizens with community feedback"})]}),(0,t.jsx)(a.CardContent,{children:0===T.length?(0,t.jsx)("p",{className:"text-sm text-muted-foreground text-center py-8",children:"No reports yet. Citizens can submit reports to see them here."}):(0,t.jsx)("div",{className:"space-y-4",children:T.map(e=>(0,t.jsxs)("a",{href:`/admin/reports/${e.id}`,className:"flex items-start gap-4 p-4 rounded-lg border border-border hover:bg-muted/50 transition-colors",children:[e.report_images&&e.report_images[0]?(0,t.jsx)("img",{src:e.report_images[0].image_url||"/placeholder.svg",alt:"Report",className:"w-16 h-16 rounded-md object-cover"}):(0,t.jsx)("div",{className:"w-16 h-16 rounded-md bg-muted flex items-center justify-center",children:(0,t.jsx)(n.FileText,{className:"h-6 w-6 text-muted-foreground"})}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("p",{className:"font-medium line-clamp-2",children:e.complaint_text}),(0,t.jsxs)("p",{className:"text-sm text-muted-foreground mt-1",children:[e.profiles?.full_name||"Anonymous"," • ",new Date(e.created_at).toLocaleString()]}),(0,t.jsxs)("div",{className:"mt-2 flex gap-2 flex-wrap items-center",children:[(e.votes.upvotes>0||e.votes.downvotes>0)&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"flex items-center gap-1 text-xs bg-green-50 dark:bg-green-950 px-2 py-1 rounded",children:[(0,t.jsx)(m.ThumbsUp,{className:"h-3 w-3 text-green-600"}),(0,t.jsx)("span",{className:"font-semibold",children:e.votes.upvotes})]}),(0,t.jsxs)("div",{className:"flex items-center gap-1 text-xs bg-red-50 dark:bg-red-950 px-2 py-1 rounded",children:[(0,t.jsx)(u.ThumbsDown,{className:"h-3 w-3 text-red-600"}),(0,t.jsx)("span",{className:"font-semibold",children:e.votes.downvotes})]}),e.communityScore>0&&(0,t.jsxs)(f.Badge,{variant:"outline",className:"text-xs",children:["Community Score: +",e.communityScore]})]}),e.ai_analysis&&(0,t.jsxs)("span",{className:"text-xs bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200 px-2 py-1 rounded",children:["AI: ",(100*e.ai_analysis.category_confidence).toFixed(0),"% confident"]}),(0,t.jsx)("span",{className:`text-xs px-2 py-1 rounded ${"critical"===e.severity_level?"bg-red-100 dark:bg-red-900 text-red-800 dark:text-red-200":"high"===e.severity_level?"bg-orange-100 dark:bg-orange-900 text-orange-800 dark:text-orange-200":"bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200"}`,children:e.severity_level?.toUpperCase()})]})]})]},e.id))})})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,t.jsxs)(a.Card,{children:[(0,t.jsx)(a.CardHeader,{children:(0,t.jsxs)(a.CardTitle,{className:"flex items-center gap-2",children:[(0,t.jsx)(c.Users,{className:"h-5 w-5"}),"Reports Overview"]})}),(0,t.jsxs)(a.CardContent,{children:[(0,t.jsx)("div",{className:"text-3xl font-bold",children:b}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:"Total reports submitted by citizens"})]})]}),(0,t.jsxs)(a.Card,{children:[(0,t.jsx)(a.CardHeader,{children:(0,t.jsx)(a.CardTitle,{children:"AI Processing Stats"})}),(0,t.jsxs)(a.CardContent,{className:"space-y-2",children:[(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:"Auto-classified:"}),(0,t.jsxs)("span",{className:"font-medium",children:[b>0?Math.round(e.filter(e=>e.ai_analysis).length/b*100):0,"%"]})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:"High confidence:"}),(0,t.jsxs)("span",{className:"font-medium",children:[b>0?Math.round(e.filter(e=>e.ai_analysis&&e.ai_analysis.category_confidence>.8).length/b*100):0,"%"]})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:"Critical issues:"}),(0,t.jsx)("span",{className:"font-medium",children:e.filter(e=>"critical"===e.severity_level).length})]})]})]})]})]})]})]})}e.s(["default",()=>g])}]);