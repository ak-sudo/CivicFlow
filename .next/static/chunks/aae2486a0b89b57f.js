(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,8673,e=>{"use strict";let t="civicflow_reports";function i(){try{let e=localStorage.getItem(t);return e?JSON.parse(e):[]}catch{return[]}}function r(e){try{let r=i();e.timeline||(e.timeline=[{id:`timeline_${Date.now()}`,action:"Report submitted",created_at:new Date().toISOString(),actor_name:e.profiles?.full_name||"Citizen",details:{category:e.category,severity:e.severity_level,ai_confidence:e.ai_analysis?.category_confidence}}]),r.unshift(e),localStorage.setItem(t,JSON.stringify(r)),window.dispatchEvent(new CustomEvent("reportsUpdated",{detail:{reports:r}}))}catch(e){console.error("Failed to save report to localStorage:",e)}}function s(e,r){try{let s=i(),a=s.findIndex(t=>t.id===e);if(-1!==a){if(r.status&&r.status!==s[a].status){let e={id:`timeline_${Date.now()}`,action:`Status changed to ${r.status}`,created_at:new Date().toISOString(),actor_name:"completed"===r.status?"Worker":"System"};s[a].timeline=s[a].timeline||[],s[a].timeline.unshift(e)}("completed"===r.status||"verified"===r.status)&&(r.verified_at=new Date().toISOString()),s[a]={...s[a],...r,updated_at:new Date().toISOString()},localStorage.setItem(t,JSON.stringify(s)),window.dispatchEvent(new CustomEvent("reportsUpdated",{detail:{reports:s}}))}}catch(e){console.error("Failed to update report in localStorage:",e)}}function a(e){return i().find(t=>t.id===e)||null}e.s(["getReportById",()=>a,"getReportsFromStorage",()=>i,"saveReportToStorage",()=>r,"updateReportInStorage",()=>s])},14471,e=>{"use strict";let t="civicflow_user_profile";function i(){try{let e=localStorage.getItem(t);return e?JSON.parse(e):null}catch{return null}}function r(e){try{localStorage.setItem(t,JSON.stringify(e)),window.dispatchEvent(new CustomEvent("profileUpdated",{detail:{profile:e}}))}catch(e){console.error("Failed to save profile to localStorage:",e)}}function s(){let e={id:"user_"+Date.now(),full_name:"Amit Verma",email:"amit.verma@example.com",phone:"+91 98765 43210",address:"Connaught Place, New Delhi, Delhi 110001",role:"citizen",created_at:new Date().toISOString(),updated_at:new Date().toISOString()},t=i();return t||r(e),t||e}e.s(["getProfileFromStorage",()=>i,"initializeDefaultProfile",()=>s,"saveProfileToStorage",()=>r])},64490,e=>{"use strict";var t=e.i(51537),i=e.i(43638),r=e.i(80486),s=e.i(32749),a=e.i(87672),n=e.i(3305),o=e.i(52264),l=e.i(14782),c=e.i(9704),d=e.i(73183),m=e.i(16221),u=e.i(3908),h=e.i(22869);function x({userName:e,unreadCount:x=0}){let f=(0,m.useRouter)(),p=async()=>{let e=(0,d.createClient)();await e.auth.signOut(),f.push("/")};return(0,t.jsx)("header",{className:"sticky top-0 z-40 border-b border-border bg-background",children:(0,t.jsxs)("div",{className:"container max-w-7xl mx-auto flex h-16 items-center justify-between px-4 md:px-6",children:[(0,t.jsxs)(i.default,{href:"/citizen/dashboard",className:"flex items-center gap-2",children:[(0,t.jsx)(u.default,{src:"/civiflow-logo.png",alt:"CivicFlow Logo",width:36,height:36,className:"object-contain"}),(0,t.jsx)("span",{className:"text-xl font-bold hidden sm:inline",children:"CivicFlow"})]}),(0,t.jsxs)("nav",{className:"flex items-center gap-6",children:[(0,t.jsx)(i.default,{href:"/citizen/dashboard",className:"text-sm font-medium hover:text-primary transition-colors",children:"Dashboard"}),(0,t.jsxs)(i.default,{href:"/civicbook",className:"text-sm font-medium hover:text-primary transition-colors flex items-center gap-1",children:[(0,t.jsx)(o.Home,{className:"h-4 w-4"}),"CivicBook"]}),(0,t.jsx)(i.default,{href:"/citizen/report",className:"text-sm font-medium hover:text-primary transition-colors",children:"Report Issue"}),(0,t.jsx)(i.default,{href:"/citizen/my-reports",className:"text-sm font-medium hover:text-primary transition-colors",children:"My Reports"}),(0,t.jsx)(i.default,{href:"/citizen/incentives",className:"text-sm font-medium hover:text-primary transition-colors",children:"Incentives"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)(r.Button,{variant:"ghost",size:"icon",className:"relative",asChild:!0,children:(0,t.jsxs)(i.default,{href:"/citizen/notifications",children:[(0,t.jsx)(s.Bell,{className:"h-5 w-5"}),x>0&&(0,t.jsx)(c.Badge,{className:"absolute -top-1 -right-1 h-5 w-5 flex items-center justify-center p-0 text-xs",children:x})]})}),(0,t.jsxs)(l.DropdownMenu,{children:[(0,t.jsx)(l.DropdownMenuTrigger,{asChild:!0,children:(0,t.jsx)(r.Button,{variant:"ghost",size:"icon",children:(0,t.jsx)(a.User,{className:"h-5 w-5"})})}),(0,t.jsxs)(l.DropdownMenuContent,{align:"end",className:"w-56",children:[(0,t.jsx)(l.DropdownMenuLabel,{children:(0,t.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,t.jsx)("p",{className:"text-sm font-medium",children:e}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Citizen Account"})]})}),(0,t.jsx)(l.DropdownMenuSeparator,{}),(0,t.jsx)(l.DropdownMenuItem,{asChild:!0,children:(0,t.jsx)(i.default,{href:"/citizen/profile",children:"Profile Settings"})}),(0,t.jsx)(l.DropdownMenuSeparator,{}),(0,t.jsxs)(l.DropdownMenuItem,{onClick:p,className:"text-destructive",children:[(0,t.jsx)(n.LogOut,{className:"mr-2 h-4 w-4"}),"Logout"]})]})]}),(0,t.jsx)(h.RoleSwitcher,{})]})]})})}e.s(["NavHeader",()=>x])},35416,e=>{"use strict";var t=e.i(51537),i=e.i(58987),r=e.i(64490),s=e.i(98121),a=e.i(9704),n=e.i(32749);let o=(0,e.i(68385).default)("BellOff",[["path",{d:"M8.7 3A6 6 0 0 1 18 8a21.3 21.3 0 0 0 .6 5",key:"o7mx20"}],["path",{d:"M17 17H3s3-2 3-9a4.67 4.67 0 0 1 .3-1.7",key:"16f1lm"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);var l=e.i(8673),c=e.i(14471),d=e.i(43638);function m(){let[e,m]=(0,i.useState)([]),u=(0,c.getProfileFromStorage)()||(0,c.initializeDefaultProfile)();return(0,i.useEffect)(()=>{let e=(0,l.getReportsFromStorage)(),t=[];e.forEach(e=>{e.timeline&&e.timeline.length>1&&e.timeline.slice(0,5).forEach(i=>{i.action.includes("Status changed")&&t.push({id:i.id,report_id:e.id,title:"Report Status Updated",message:`Your report "${e.complaint_text.substring(0,50)}..." ${i.action.toLowerCase()}`,created_at:i.created_at,status:e.status,is_read:!1})})}),m(t)},[]),(0,t.jsxs)("div",{className:"min-h-screen bg-background",children:[(0,t.jsx)(r.NavHeader,{userName:u.full_name,unreadCount:e.length}),(0,t.jsx)("main",{className:"container px-4 md:px-6 py-8 max-w-4xl mx-auto",children:(0,t.jsxs)(s.Card,{children:[(0,t.jsxs)(s.CardHeader,{children:[(0,t.jsx)(s.CardTitle,{children:"Notifications / सूचनाएं"}),(0,t.jsx)(s.CardDescription,{children:"Stay updated on your report status / अपनी रिपोर्ट की स्थिति पर अपडेट रहें"})]}),(0,t.jsx)(s.CardContent,{children:0===e.length?(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[(0,t.jsx)(o,{className:"h-12 w-12 text-muted-foreground mb-4"}),(0,t.jsx)("h3",{className:"font-semibold text-lg mb-2",children:"No notifications / कोई सूचना नहीं"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"You're all caught up! / आप पूरी तरह से अपडेट हैं!"})]}):(0,t.jsx)("div",{className:"space-y-3",children:e.map(e=>(0,t.jsxs)(d.default,{href:`/citizen/reports/${e.report_id}`,className:"flex items-start gap-4 p-4 rounded-lg border border-border hover:bg-muted/50 transition-colors",children:[(0,t.jsx)("div",{className:"flex-shrink-0 mt-1",children:(0,t.jsx)("div",{className:"w-10 h-10 rounded-full bg-primary/10 flex items-center justify-center",children:(0,t.jsx)(n.Bell,{className:"h-5 w-5 text-primary"})})}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsxs)("div",{className:"flex items-start justify-between gap-2 mb-1",children:[(0,t.jsx)("p",{className:"font-medium",children:e.title}),(0,t.jsx)(a.Badge,{variant:"secondary",className:"flex-shrink-0",children:e.status})]}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground mb-2",children:e.message}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:new Date(e.created_at).toLocaleString()})]})]},e.id))})})]})})]})}e.s(["default",()=>m],35416)}]);