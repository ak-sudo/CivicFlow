{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///Users/akshatkala/Downloads/geminiaiintegration/app/api/ai/gemini/analyze/route.ts"],"sourcesContent":["import { type NextRequest, NextResponse } from \"next/server\"\nimport { GoogleGenerativeAI, HarmCategory, HarmBlockThreshold } from \"@google/generative-ai\"\nimport type { ReportCategory } from \"@/lib/types/database\"\n\nexport async function POST(request: NextRequest) {\n  try {\n    const body = await request.json()\n    const { imageBase64, complaintText, location } = body\n\n    console.log(\"[v0] Enhanced AI analysis request received\")\n\n    // Get Gemini API key from environment\n    const GEMINI_API_KEY = process.env.GEMINI_API_KEY\n\n    if (!GEMINI_API_KEY) {\n      console.warn(\"[v0] GEMINI_API_KEY not found, using mock analysis\")\n      return mockAnalysis(imageBase64, complaintText, location)\n    }\n\n    try {\n      const genAI = new GoogleGenerativeAI(GEMINI_API_KEY)\n\n      const model = genAI.getGenerativeModel({\n        model: \"gemini-2.5-flash\",\n        safetySettings: [\n          {\n            category: HarmCategory.HARM_CATEGORY_HARASSMENT,\n            threshold: HarmBlockThreshold.BLOCK_NONE,\n          },\n          {\n            category: HarmCategory.HARM_CATEGORY_HATE_SPEECH,\n            threshold: HarmBlockThreshold.BLOCK_NONE,\n          },\n          {\n            category: HarmCategory.HARM_CATEGORY_SEXUALLY_EXPLICIT,\n            threshold: HarmBlockThreshold.BLOCK_NONE,\n          },\n          {\n            category: HarmCategory.HARM_CATEGORY_DANGEROUS_CONTENT,\n            threshold: HarmBlockThreshold.BLOCK_NONE,\n          },\n        ],\n      })\n\n      const prompt = `You are an expert civic infrastructure analyst for Indian municipalities. Analyze this image showing a civic infrastructure problem.\n\nComplaint: \"${complaintText}\"\nLocation: ${location?.lat}, ${location?.lng} (${location?.address || \"India\"})\n\nThis is a legitimate civic infrastructure report. The image may show potholes, garbage, broken streetlights, dead animals on roads, or sewage issues. Please analyze objectively for municipal action.\n\nProvide comprehensive analysis in this exact JSON format with ALL fields filled:\n{\n  \"detected_category\": \"pothole|waste_overflow|streetlight_out|traffic_signal_fault|carcass_on_road|public_toilet_unclean|damaged_pathway|sewage_overflow|other\",\n  \"confidence\": 0.85,\n  \"severity\": 75,\n  \"description\": \"Clear, detailed description of the civic issue visible in the image\",\n  \"measurements\": {\n    \"pothole_depth_cm\": 12,\n    \"garbage_volume_cubic_meters\": 5.5,\n    \"affected_area_square_meters\": 8.0,\n    \"is_dead_animal\": false,\n    \"is_low_light_area\": false,\n    \"sewage_volume_liters\": null\n  },\n  \"health_risks\": [\"mosquito breeding\", \"disease transmission\", \"accident risk\"],\n  \"urgency_level\": \"high\",\n  \"expected_resolution_time_hours\": 24,\n  \"assigned_department\": \"PWD\",\n  \"possible_cause\": \"Heavy rainfall causing road deterioration and lack of maintenance\",\n  \"next_steps\": [\"Deploy repair team within 24 hours\", \"Set up warning signs\", \"Fill pothole with asphalt\"],\n  \"auto_escalate\": false,\n  \"escalation_reason\": null,\n  \"work_order\": {\n    \"priority\": \"high\",\n    \"estimated_workers\": 3,\n    \"required_equipment\": [\"asphalt mixture\", \"road roller\", \"safety cones\"],\n    \"safety_precautions\": [\"warning signs\", \"traffic control\", \"safety vests\"],\n    \"estimated_cost_inr\": 15000,\n    \"estimated_duration_hours\": 6\n  },\n  \"root_cause_analysis\": {\n    \"primary_cause\": \"Poor drainage system leading to water accumulation\",\n    \"contributing_factors\": [\"Heavy monsoon\", \"Aging infrastructure\", \"Inadequate maintenance\"],\n    \"recurring_issue\": true,\n    \"prevention_measures\": [\"Improve drainage\", \"Regular inspections\", \"Preventive maintenance\"],\n    \"similar_issues_in_area\": 3\n  },\n  \"municipal_staff_instructions\": {\n    \"immediate_actions\": [\"Deploy team within 2 hours\", \"Set up safety barriers\"],\n    \"location_based_route\": \"Via ${location?.address || \"nearest PWD office\"}\",\n    \"tools_checklist\": [\"Repair kit\", \"Safety gear\", \"Traffic cones\"],\n    \"completion_verification\": [\"Photo documentation\", \"Quality check\", \"Citizen notification\"]\n  },\n  \"health_hazard_predictions\": {\n    \"mosquito_breeding_risk\": \"medium\",\n    \"contamination_risk\": \"low\",\n    \"accident_risk\": \"high\",\n    \"crime_risk_due_to_darkness\": \"low\",\n    \"overall_risk_score\": 70\n  }\n}`\n\n      // Convert base64 to proper format for Gemini\n      const imageParts = [\n        {\n          inlineData: {\n            data: imageBase64,\n            mimeType: \"image/jpeg\",\n          },\n        },\n      ]\n\n      const result = await model.generateContent([prompt, ...imageParts])\n      const response = await result.response\n\n      if (!response || !response.text) {\n        console.warn(\"[v0] Gemini response blocked or empty, using mock analysis\")\n        return mockAnalysis(imageBase64, complaintText, location)\n      }\n\n      const text = response.text()\n      console.log(\"[v0] Gemini response received\")\n\n      // Parse JSON from AI response\n      const cleanedText = text.replace(/```json|```/g, \"\").trim()\n      const jsonMatch = cleanedText.match(/\\{[\\s\\S]*\\}/)\n      const aiAnalysis = jsonMatch ? JSON.parse(jsonMatch[0]) : null\n\n      if (!aiAnalysis) {\n        console.warn(\"[v0] Failed to parse AI response, using mock analysis\")\n        return mockAnalysis(imageBase64, complaintText, location)\n      }\n\n      // Map category to our system\n      const categoryMap: Record<string, ReportCategory> = {\n        pothole: \"pothole\",\n        waste_overflow: \"waste_overflow\",\n        streetlight_out: \"streetlight_out\",\n        traffic_signal_fault: \"traffic_signal_fault\",\n        carcass_on_road: \"carcass_on_road\",\n        public_toilet_unclean: \"public_toilet_unclean\",\n        damaged_pathway: \"damaged_pathway\",\n        sewage_overflow: \"other\",\n        other: \"other\",\n      }\n\n      const finalCategory = categoryMap[aiAnalysis.detected_category] || \"other\"\n      const finalSeverity = aiAnalysis.severity || 50\n\n      const apiResponse = {\n        success: true,\n        analysis: {\n          predicted_category: finalCategory,\n          category_confidence: aiAnalysis.confidence,\n          final_severity: finalSeverity,\n          severity_level: getSeverityLevel(finalSeverity),\n          description: aiAnalysis.description,\n          measurements: aiAnalysis.measurements,\n          health_risks: aiAnalysis.health_risks || [],\n          urgency_level: aiAnalysis.urgency_level,\n          expected_resolution_time: `${aiAnalysis.expected_resolution_time_hours} hours`,\n          assigned_department: aiAnalysis.assigned_department,\n          possible_cause: aiAnalysis.possible_cause,\n          next_steps: aiAnalysis.next_steps || [],\n          auto_escalate: aiAnalysis.auto_escalate || false,\n          escalation_reason: aiAnalysis.escalation_reason,\n          work_order: aiAnalysis.work_order,\n          root_cause_analysis: aiAnalysis.root_cause_analysis,\n          municipal_staff_instructions: aiAnalysis.municipal_staff_instructions,\n          health_hazard_predictions: aiAnalysis.health_hazard_predictions,\n          needs_human_review: aiAnalysis.confidence < 0.7 || aiAnalysis.urgency_level === \"critical\",\n          processed_at: new Date().toISOString(),\n          gemini_raw: aiAnalysis,\n        },\n      }\n\n      console.log(\"[v0] Comprehensive Gemini AI analysis complete\")\n\n      return NextResponse.json(apiResponse)\n    } catch (apiError: any) {\n      console.error(\"[v0] Gemini API error, falling back to mock:\", apiError.message)\n      return mockAnalysis(imageBase64, complaintText, location)\n    }\n  } catch (error: any) {\n    console.error(\"[v0] AI analysis error:\", error)\n    return NextResponse.json({ success: false, error: error.message }, { status: 500 })\n  }\n}\n\nfunction mockAnalysis(imageBase64: string, complaintText: string, location: any) {\n  const category = determineCategoryFromText(complaintText)\n  const severity = 50 + Math.floor(Math.random() * 40)\n  const confidence = 0.75 + Math.random() * 0.2\n\n  const mockResponse = {\n    success: true,\n    analysis: {\n      predicted_category: category,\n      category_confidence: confidence,\n      final_severity: severity,\n      severity_level: getSeverityLevel(severity),\n      description: `AI detected ${category.replace(/_/g, \" \")} based on image analysis. ${complaintText.slice(0, 100)}`,\n      measurements: getMockMeasurements(category),\n      health_risks: getHealthRisks(category),\n      urgency_level: severity > 75 ? \"high\" : severity > 50 ? \"medium\" : \"low\",\n      expected_resolution_time: `${severity > 75 ? 12 : severity > 50 ? 24 : 48} hours`,\n      assigned_department: getDepartmentForCategory(category),\n      possible_cause: getPossibleCause(category),\n      next_steps: getNextSteps(category),\n      auto_escalate: severity > 85,\n      escalation_reason: severity > 85 ? \"Critical severity detected requiring immediate attention\" : null,\n      work_order: {\n        priority: severity > 75 ? \"high\" : severity > 50 ? \"medium\" : \"low\",\n        estimated_workers: category === \"pothole\" ? 3 : 2,\n        required_equipment: getRequiredEquipment(category),\n        safety_precautions: getSafetyPrecautions(category),\n        estimated_cost_inr: severity > 75 ? 25000 : severity > 50 ? 15000 : 8000,\n        estimated_duration_hours: severity > 75 ? 8 : severity > 50 ? 6 : 4,\n      },\n      root_cause_analysis: {\n        primary_cause: getRootCause(category),\n        contributing_factors: getContributingFactors(category),\n        recurring_issue: Math.random() > 0.5,\n        prevention_measures: getPreventionMeasures(category),\n        similar_issues_in_area: Math.floor(Math.random() * 5),\n      },\n      municipal_staff_instructions: {\n        immediate_actions: getNextSteps(category).slice(0, 2),\n        location_based_route: `Via ${location?.address || \"nearest municipal office\"} - optimized route`,\n        tools_checklist: getRequiredEquipment(category),\n        completion_verification: [\"Photo documentation\", \"Quality inspection\", \"Notify citizen via app\"],\n      },\n      health_hazard_predictions: {\n        mosquito_breeding_risk: category === \"waste_overflow\" ? \"high\" : \"low\",\n        contamination_risk: category === \"sewage_overflow\" || category === \"waste_overflow\" ? \"high\" : \"low\",\n        accident_risk: category === \"pothole\" || category === \"damaged_pathway\" ? \"high\" : \"low\",\n        crime_risk_due_to_darkness: category === \"streetlight_out\" ? \"medium\" : \"low\",\n        overall_risk_score: severity,\n      },\n      needs_human_review: confidence < 0.7 || severity > 85,\n      processed_at: new Date().toISOString(),\n      gemini_raw: { note: \"Mock analysis - Gemini API key not configured or rate limited\" },\n    },\n  }\n\n  return NextResponse.json(mockResponse)\n}\n\nfunction determineCategoryFromText(text: string): ReportCategory {\n  const lowerText = text.toLowerCase()\n  if (lowerText.includes(\"pothole\") || lowerText.includes(\"गड्ढा\")) return \"pothole\"\n  if (lowerText.includes(\"garbage\") || lowerText.includes(\"कचरा\") || lowerText.includes(\"waste\"))\n    return \"waste_overflow\"\n  if (lowerText.includes(\"light\") || lowerText.includes(\"लाइट\")) return \"streetlight_out\"\n  if (lowerText.includes(\"signal\") || lowerText.includes(\"traffic\")) return \"traffic_signal_fault\"\n  if (lowerText.includes(\"animal\") || lowerText.includes(\"carcass\") || lowerText.includes(\"dead\"))\n    return \"carcass_on_road\"\n  if (lowerText.includes(\"toilet\") || lowerText.includes(\"शौचालय\")) return \"public_toilet_unclean\"\n  if (lowerText.includes(\"pathway\") || lowerText.includes(\"pavement\")) return \"damaged_pathway\"\n  return \"other\"\n}\n\nfunction getSeverityLevel(score: number): \"low\" | \"medium\" | \"high\" | \"critical\" {\n  if (score >= 85) return \"critical\"\n  if (score >= 65) return \"high\"\n  if (score >= 40) return \"medium\"\n  return \"low\"\n}\n\nfunction getMockMeasurements(category: ReportCategory) {\n  const measurements: any = {\n    pothole_depth_cm: null,\n    garbage_volume_cubic_meters: null,\n    affected_area_square_meters: null,\n    is_dead_animal: false,\n    is_low_light_area: false,\n    sewage_volume_liters: null,\n  }\n\n  if (category === \"pothole\") {\n    measurements.pothole_depth_cm = 8 + Math.floor(Math.random() * 15)\n    measurements.affected_area_square_meters = 0.5 + Math.random() * 2\n  } else if (category === \"waste_overflow\") {\n    measurements.garbage_volume_cubic_meters = 2 + Math.random() * 8\n    measurements.affected_area_square_meters = 5 + Math.random() * 15\n  } else if (category === \"carcass_on_road\") {\n    measurements.is_dead_animal = true\n    measurements.affected_area_square_meters = 1 + Math.random() * 3\n  } else if (category === \"streetlight_out\") {\n    measurements.is_low_light_area = true\n  }\n\n  return measurements\n}\n\nfunction getHealthRisks(category: ReportCategory): string[] {\n  const risks: Record<ReportCategory, string[]> = {\n    pothole: [\"Accident risk\", \"Vehicle damage\", \"Pedestrian injuries\"],\n    waste_overflow: [\"Mosquito breeding\", \"Disease transmission\", \"Foul odor\", \"Rat infestation\"],\n    streetlight_out: [\"Crime risk\", \"Accident risk at night\", \"Pedestrian safety concern\"],\n    traffic_signal_fault: [\"Traffic accidents\", \"Road rage incidents\", \"Congestion\"],\n    carcass_on_road: [\n      \"Disease transmission\",\n      \"Contamination of water/food\",\n      \"Foul odor\",\n      \"Fly breeding\",\n      \"Public health emergency\",\n    ],\n    public_toilet_unclean: [\"Disease transmission\", \"Bacterial infection risk\", \"Unhygienic conditions\"],\n    damaged_pathway: [\"Trip hazard\", \"Elderly fall risk\", \"Wheelchair accessibility issue\"],\n    other: [\"General safety concern\"],\n  }\n  return risks[category] || risks.other\n}\n\nfunction getDepartmentForCategory(category: ReportCategory): string {\n  const deptMap: Record<ReportCategory, string> = {\n    pothole: \"PWD\",\n    damaged_pathway: \"PWD\",\n    waste_overflow: \"SWM\",\n    streetlight_out: \"ELECTRICAL\",\n    traffic_signal_fault: \"TRAFFIC\",\n    carcass_on_road: \"HEALTH\",\n    public_toilet_unclean: \"SANITATION\",\n    other: \"HELPDESK\",\n  }\n  return deptMap[category] || \"HELPDESK\"\n}\n\nfunction getPossibleCause(category: ReportCategory): string {\n  const causes: Record<ReportCategory, string> = {\n    pothole: \"Heavy monsoon rainfall causing road surface deterioration and inadequate road maintenance\",\n    waste_overflow: \"Irregular waste collection schedule and insufficient bin capacity for the area\",\n    streetlight_out: \"Electrical fault or bulb/fixture damage due to weather or vandalism\",\n    traffic_signal_fault: \"Electrical malfunction or timer system failure\",\n    carcass_on_road: \"Stray animal death, requires immediate removal for public health\",\n    public_toilet_unclean: \"Inadequate cleaning schedule and lack of regular maintenance\",\n    damaged_pathway: \"Weather erosion, heavy foot traffic, or poor initial construction\",\n    other: \"Requires further investigation to determine root cause\",\n  }\n  return causes[category] || causes.other\n}\n\nfunction getNextSteps(category: ReportCategory): string[] {\n  const steps: Record<ReportCategory, string[]> = {\n    pothole: [\n      \"Dispatch road repair team within 24 hours\",\n      \"Set up warning signs and barriers\",\n      \"Fill pothole with asphalt mixture\",\n      \"Inspect surrounding area for additional damage\",\n    ],\n    waste_overflow: [\n      \"Send waste collection team immediately\",\n      \"Clean and sanitize affected area\",\n      \"Increase collection frequency for this location\",\n      \"Add additional bins if needed\",\n    ],\n    streetlight_out: [\n      \"Send electrician to inspect within 12 hours\",\n      \"Replace bulb or repair fixture\",\n      \"Test electrical connections\",\n      \"Add to regular maintenance schedule\",\n    ],\n    traffic_signal_fault: [\n      \"Alert traffic police immediately\",\n      \"Deploy manual traffic control\",\n      \"Send technician for emergency repair\",\n      \"Install temporary signals if needed\",\n    ],\n    carcass_on_road: [\n      \"Dispatch health team immediately (within 2 hours)\",\n      \"Remove and dispose of carcass safely\",\n      \"Sanitize affected area thoroughly\",\n      \"Investigate source and prevent recurrence\",\n    ],\n    public_toilet_unclean: [\n      \"Send sanitation team for deep cleaning\",\n      \"Repair any damaged facilities\",\n      \"Increase cleaning frequency\",\n      \"Install hygiene monitoring system\",\n    ],\n    damaged_pathway: [\n      \"Inspect extent of damage\",\n      \"Set up barriers for safety\",\n      \"Schedule repair work\",\n      \"Resurface affected area\",\n    ],\n    other: [\"Assess situation\", \"Assign to appropriate department\", \"Schedule site inspection\"],\n  }\n  return steps[category] || steps.other\n}\n\nfunction getRequiredEquipment(category: ReportCategory): string[] {\n  const equipment: Record<ReportCategory, string[]> = {\n    pothole: [\"Asphalt mixture\", \"Road roller\", \"Safety cones\", \"Jackhammer\"],\n    waste_overflow: [\"Garbage truck\", \"Cleaning tools\", \"Sanitizer\", \"Additional bins\"],\n    streetlight_out: [\"Ladder\", \"Replacement bulbs\", \"Electrical testing equipment\", \"Safety gear\"],\n    traffic_signal_fault: [\"Signal repair tools\", \"Replacement parts\", \"Testing equipment\", \"Traffic cones\"],\n    carcass_on_road: [\"Protective suits\", \"Sanitizing equipment\", \"Body bags\", \"Disposal vehicle\"],\n    public_toilet_unclean: [\"Cleaning supplies\", \"Disinfectants\", \"Repair tools\", \"Protective gear\"],\n    damaged_pathway: [\"Concrete mixer\", \"Paving stones\", \"Safety barriers\", \"Leveling tools\"],\n    other: [\"Standard municipal equipment\"],\n  }\n  return equipment[category] || equipment.other\n}\n\nfunction getSafetyPrecautions(category: ReportCategory): string[] {\n  const precautions: Record<ReportCategory, string[]> = {\n    pothole: [\"Set up warning signs\", \"Use safety vests\", \"Divert traffic if needed\"],\n    waste_overflow: [\"Wear protective gloves\", \"Use face masks\", \"Sanitize after work\"],\n    streetlight_out: [\"Work during daylight if possible\", \"Use safety harness\", \"Follow electrical safety protocols\"],\n    traffic_signal_fault: [\n      \"Coordinate with traffic police\",\n      \"Use high-visibility clothing\",\n      \"Work during low-traffic hours\",\n    ],\n    carcass_on_road: [\n      \"Wear full protective equipment\",\n      \"Follow biohazard protocols\",\n      \"Sanitize all equipment\",\n      \"Report to health department\",\n    ],\n    public_toilet_unclean: [\"Wear protective gear\", \"Use proper ventilation\", \"Follow sanitation protocols\"],\n    damaged_pathway: [\"Cordon off work area\", \"Warn pedestrians\", \"Ensure proper lighting\"],\n    other: [\"Follow standard safety procedures\"],\n  }\n  return precautions[category] || precautions.other\n}\n\nfunction getRootCause(category: ReportCategory): string {\n  const causes: Record<ReportCategory, string> = {\n    pothole: \"Poor drainage system causing water accumulation and road deterioration\",\n    waste_overflow: \"Inadequate waste collection frequency and insufficient bin capacity\",\n    streetlight_out: \"Aging electrical infrastructure and lack of preventive maintenance\",\n    traffic_signal_fault: \"Power fluctuations and lack of backup systems\",\n    carcass_on_road: \"Stray animal population and lack of animal control measures\",\n    public_toilet_unclean: \"Insufficient cleaning staff and lack of regular maintenance schedule\",\n    damaged_pathway: \"Heavy foot traffic combined with poor quality construction materials\",\n    other: \"Multiple factors contributing to infrastructure degradation\",\n  }\n  return causes[category] || causes.other\n}\n\nfunction getContributingFactors(category: ReportCategory): string[] {\n  const factors: Record<ReportCategory, string[]> = {\n    pothole: [\"Heavy monsoon rainfall\", \"High traffic volume\", \"Poor quality asphalt\", \"Delayed maintenance\"],\n    waste_overflow: [\"Population growth\", \"Irregular collection\", \"Insufficient bins\", \"Lack of segregation\"],\n    streetlight_out: [\"Weather damage\", \"Vandalism\", \"Power surges\", \"Old fixtures\"],\n    traffic_signal_fault: [\"Power outages\", \"Component failure\", \"Weather conditions\", \"Lack of monitoring\"],\n    carcass_on_road: [\"Stray animal accidents\", \"Delayed reporting\", \"Limited cleanup resources\"],\n    public_toilet_unclean: [\"High usage\", \"Insufficient cleaning\", \"Vandalism\", \"Water shortage\"],\n    damaged_pathway: [\"Weather erosion\", \"Tree roots\", \"Poor drainage\", \"Construction defects\"],\n    other: [\"Multiple environmental and human factors\"],\n  }\n  return factors[category] || factors.other\n}\n\nfunction getPreventionMeasures(category: ReportCategory): string[] {\n  const measures: Record<ReportCategory, string[]> = {\n    pothole: [\"Regular road inspections\", \"Improved drainage\", \"Quality materials\", \"Timely repairs\"],\n    waste_overflow: [\"Increase bin capacity\", \"More frequent collection\", \"Public awareness\", \"Waste segregation\"],\n    streetlight_out: [\"Preventive maintenance\", \"LED upgrades\", \"Remote monitoring\", \"Quick response team\"],\n    traffic_signal_fault: [\"Backup power systems\", \"Regular testing\", \"Modern controllers\", \"24/7 monitoring\"],\n    carcass_on_road: [\n      \"Animal control programs\",\n      \"Quick response system\",\n      \"Public reporting app\",\n      \"Awareness campaigns\",\n    ],\n    public_toilet_unclean: [\"More cleaning staff\", \"Regular schedules\", \"User feedback system\", \"Better facilities\"],\n    damaged_pathway: [\"Quality construction\", \"Regular maintenance\", \"Proper drainage\", \"Tree management\"],\n    other: [\"Regular monitoring and preventive maintenance\"],\n  }\n  return measures[category] || measures.other\n}\n"],"names":[],"mappings":"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"}}]
}